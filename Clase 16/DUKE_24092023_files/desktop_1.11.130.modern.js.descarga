!function(){"use strict";const e=["finance.yahoo.com","news.yahoo.com","sports.yahoo.com"],t=new RegExp(/rs="([^"]*)"/),i={lmsid:"lmsid",lpstaid:"lpstaid",lu:"lu",pct:"pageContentType",pd:"pageDesign",pl:"pl",pt:"pageType",revsp:"revsp",ver:"appName"},s=["ctopid","hashtag","wiki_topics"],n=["pd","pt","pct","lmsid","lpstaid"],o={att:"yhp",autos:"yautos",entertainment:"yent",finance:"yfin",fp:"yhp",gma:"ynews",lifestyle:"ylife",movies:"ymov",music:"yent",news:"ynews",sports:"ysports",style:"ylife",tech:"ynews"};const a=e=>new Promise((t=>setTimeout(t,e))),r=(e,{className:t,id:i,tagName:s})=>{if(e)return t&&!e.classList.contains(t)||i&&i!==e.id||s&&e.tagName!==s?r(e.parentElement,{className:t,id:i,tagName:s}):e},c=t=>{if(!t||t.startsWith("/"))return t;const{hostname:i,pathname:s}=new URL(t);if(e.includes(i)&&i!==window.location.hostname){const[e]=i.split(".");return`/${e}${s}`}return s},d=e=>{const{hostname:t}=new URL(e);return t||""},l=e=>{if(!e||!e.parentElement)return;const t=r(e.parentElement,{id:"content-articles-wrapper"});if(!t)return;const i=t.querySelectorAll("div.wafer-caas,div.wafer-caas-complete");return Array.from(i).findIndex((t=>t===e))+1},h=()=>window.vzm?.getPageContext?.()||window.YAHOO?.context,w=()=>{const e=h();return String(e?.bucket||e?.bucketId||"")};function p(e){const t=[];for(const i in e)if(e.hasOwnProperty(i)){const s=e[i];void 0!==s&&t.push(`${i}=${s}`)}return t.join("&")}function m(e){let t="error/p.gif";return"finance"!==e&&"news"!==e&&"sports"!==e||(t="_td_api/beacon/error"),t}function u(){const e=window.navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection)||{};return{downlink:t.downlink||"",downlinkMax:t.downlinkMax||"",effectiveType:t.effectiveType||"",rtt:t.rtt||"",saveData:t.saveData||"",type:t.type||""}}const f=e=>{if(e)return e.hasAttribute("data-uuid")?e.getAttribute("data-uuid"):e.hasAttribute("data-wf-caas-uuid")?e.getAttribute("data-wf-caas-uuid"):f(e.parentElement)},g=(e,t)=>{let i=e;for(const e of t.split(".")){if(!i||!i.hasOwnProperty(e))return;i=i[e]}return i},v=()=>{const{hostname:e,port:t,protocol:i}=window.location;return"localhost"!==e&&"4443"!==t&&"http:"!==i},y=e=>{const t=h(),i=w();return{pg:{device:t.device||"",intl:t.intl||"",property:e,rid:t.rid,test:i}}},A=e=>(window.wafer.features.isPWA&&(e=((e,t,i)=>{const s=new URL(e);return s.searchParams.set(t,i),s.href})(e,"apptype","pwa")),e),b=(e,t)=>{if(window.benji&&"function"==typeof window.benji.updateI13N){const{adMeta:i,spaceId:s,homepageUrl:o}=e.meta.data,a={},r="frontpage"===t||"fp"===t;a.spaceid=i.spaceid||s||"",i.hashtag&&(a.hashtag=i.hashtag.split(";")),r&&i.site&&(a.site=i.site),a.url=o||"";(i.rs&&i.rs.split(";")||[]).forEach((e=>{const t=e.split(":"),i=t[0],s=t[1];n.includes(i)&&(a[i]=s)})),window.benji.updateI13N(a)}},C=(e,t,i)=>{const s=JSON.parse(JSON.stringify(t));let n=i;for(const a in t)if(s[a]){const t=s[a].path||"";"frontpage"!==i&&"fp"!==i||(n=e.meta?.data?.adMeta?.site),s[a].path=t.replaceAll("${SITE}",n in o?o[n]:"yhp");const r=l(e.elem);if(r&&r>1){const e=`${s[a].id}-${r}`;s[e]=Object.assign({},s[a],{id:e}),delete s[a]}}return s},S="init",I="onClick",k="onContentWillChange",P="onContentChange",E="onContentDidChange",V="onViewerWillOpen",N="onViewerOpened",L="onViewerClosed",O="onViewerDidClose";var x={__proto__:null,init:S,onClick:I,onContentWillChange:k,onContentChange:P,onContentDidChange:E,onViewerWillOpen:V,onViewerOpened:N,onViewerClosed:L,onViewerDidClose:O};const M="AUTO",R=["INARTICLE","INARTICLE-1","WIDGET","WIDGET-1","WIDGETA"],T=["caas-image-lightbox"],B={att:"sbc",frontier:"ftr",rogers:"rogers-acs"},D=["WIDGETA"];const F={article:"story",cavideo:"video",photoset:"story",preview:"story",slideshow:"story"};const U=window.performance&&"clearMarks"in window.performance;const{body:$}=document,_="viewer-presentation-prestige";const H=[new class{constructor(e){this.articleUrl="",this.clusterArticleRapidConfig={},this.clusterSize=e.clusterSize,this.config=e,this.homeUrl=window.location.href,this.keys={},this.mainArticleRapidConfig={},this.moduleProgressionElmId="",this.refererUrl="",this.spaceid="",this.viewedArticles=new Set}init(e){const t=e?.clickHandler,i=e?.mainArticleRapidConfig||{},s=e?.clusterArticleRapidConfig||{};if(t){const{clusterSize:e}=t;e&&(this.clusterSize=e)}window.wafer.on("caas:article:init",this.updateRapidAttributes.bind(this)),window.wafer.on("caas:article:inview",this.beacon.bind(this)),this.keys=window.rapidInstance?.getRapidAttribute("keys"),this.spaceid=window.rapidInstance?.getRapidAttribute("spaceid"),this.mainArticleRapidConfig=i,this.clusterArticleRapidConfig=s}onViewerWillOpen(){this.homeUrl=location.href,this.viewedArticles.clear()}onClick(e){"slideshow"===e.type?this.onSlideshowClick(e):"link"===e.type&&this.onLinkClick(e)}async onViewerClosed({type:e,ylk:t}){if(!window.rapidInstance)return;const i=this.spaceid,s={_R:this.articleUrl,_w:this.homeUrl,navtype:"client"},n={elm:"backbtn",elmt:"cl",itc:0,rspns:"cl",tar:d(this.homeUrl),tar_uri:"/",...t||{}},o=n.slk;let a;o?a=o:(a="desktop"===this.config.device?"article-modal-close":"close-back-btn","back"===e&&"desktop"===this.config.device&&(a="browser-close"));const r=t?.sec||("desktop"===this.config.device?"hl-viewer":"hd");window.rapidInstance.beaconClick(r,a,0,n,"",void 0,{dwell:"stop"}),window.YAHOO&&window.YAHOO.i13n&&(window.YAHOO.i13n.SPACEID=parseInt(i,10)),window.rapidInstance.clearRapidAttribute(["keys"]),window.rapidInstance.setRapidAttribute({keys:Object.assign({},this.keys,s),spaceid:i}),window.rapidInstance.beaconPageview(s),this.flushModuleProgression()}async onContentWillChange(e){this.refererUrl=e.refererUrl}async beacon(e){this.flushModuleProgression(),await this.beaconDwellStop(),this.beaconModalContent(e),this.refererUrl!==window.location.href&&(this.refererUrl=window.location.href),this.viewedArticles.add(e.elem.id)}updateRapidAttributes(e){if(!window.rapidInstance)return;const{elem:t,meta:{data:i}}=e,{adMeta:s,canonicalUrl:n,contentType:o,hasYahooVideo:a,hideAllAds:r=!1,homepageUrl:c,hostedType:d,presentation:h,previewLink:w,publisher:p,spaceId:m,url:u,uuid:f,videoPosition:g}=i,v="hosted"===d,y="prestige"===h?"prestige-modal":"modal";this.articleUrl=!v&&w||c||u||n;const A={_R:this.refererUrl||this.homeUrl,_w:this.articleUrl,navtype:"client",p_cpos:l(e.elem),p_hosted:v?"onnet":"offnet",pcp:p,pct:F[o]||o,pd:y,prefcnt:this.clusterSize+1,pstaid:f,pt:"content",rspns:"nav",site:s?.site||this.keys.site,slk:e.meta.data.title,vidPos:a&&g?g:""};r&&(A.milestone="hide_ads_all"),"mainArticle"!==t.id?(A.expn="perpetual-post",Object.assign(A,this.clusterArticleRapidConfig)):Object.assign(A,this.mainArticleRapidConfig);const b=window.wafer.base.state.viewerMainArticleListId||"";A.pl2&&b.length>1&&"wf-state-reset"!==b&&(A.pl2+="-editorial"),window.rapidInstance?.setRapidAttribute({keys:A,spaceid:m}),window.YAHOO&&window.YAHOO.i13n&&(window.YAHOO.i13n.SPACEID=parseInt(m,10))}beaconModalContent(e){if(!window.rapidInstance)return;const{elem:{id:t}}=e;this.updateRapidAttributes(e),window.rapidInstance.beaconPageview(),window.rapidInstance.isModuleTracked(t)?window.rapidInstance.refreshModule(t,!1,!0):window.rapidInstance.addModules(t,!1,{setViewability:!0}),this.viewedArticles.has(t)||(window.rapidInstance.addModuleProgression?.(t),this.moduleProgressionElmId=t)}async beaconDwellStop(){return new Promise((e=>{window.rapidInstance&&window.rapidInstance.beaconClick("rapidDwell","",0,{},"",e,{dwell:"stop"})}))}flushModuleProgression(){window.rapidInstance&&this.moduleProgressionElmId&&(window.rapidInstance.endModuleProgression?.(this.moduleProgressionElmId),this.moduleProgressionElmId="")}onSlideshowClick(e){if(!window.rapidInstance)return;const{pos:t,ylk:i}=e.payload;window.rapidInstance.beaconClick("sshow",i.slk,t,i,i.outcm,void 0,{dwell:"stop"}),window.rapidInstance.beaconPageview({pct:"slideshow"})}onLinkClick(e){if(!window.rapidInstance)return;const{pos:t,ylk:i}=e.payload,{sec:s="content-canvas"}=i;window.rapidInstance.beaconClick(s,i.slk,t,i,i.outcm)}}({clusterSize:2,device:"desktop"}),new class{constructor(){this.event="homepage-viewer",this.viewportEvent="homepage-viewer-viewport",this.onScrollHandle=null,this.viewportAdPositions=[],this.viewportAdFetchSlotIndex=[],this.viewportPreviousAdFetchSlotIndex=[],this.pageContext={},this.viewerAdsConfig={}}init(e){const{adsConfig:t,wafer:i}=window;if(e&&(this.site=e.context?.site||"fp",this.viewerAdsConfig=e.ads||{}),this.pageContext=h()||{},t)this.config=t;else{(new Image).src=`/${m(this.site)}?error=no_ads_config`}this.caasViewer=document.getElementById("content-viewer"),this.rotateIndexPageAds=e?.ads?.rotateIndexPageAds||!1,this.enableAdditionalPageContextParams=e?.ads?.enableAdditionalPageContextParams||this.config?.enableAdditionalPageContextParams||!1,this.enableYieldAds=e?.enableYieldAds||this.config?.enableYieldAds,this.enableGAMAds=e?.enableGAMAds||this.config?.enableGAMAds,i.on("caas:article:init",this.displayAds.bind(this)),i.on("caas:article:init",this.setWaferState.bind(this)),i.on("caas:article:init",this.onPreParseAds.bind(this)),i.on("caas:article:pre:inview",this.setWaferState.bind(this)),i.on("caas:article:pre:inview",this.updateWaferStateInView.bind(this)),i.on("caas:article:inview",this.onArticleInview.bind(this)),i.on("lightbox:open",this.onLightboxOpen.bind(this)),i.on("lightbox:close",this.onLightboxClose.bind(this)),window.addEventListener("viewerScrollRestored",this.onviewerScrollRestored.bind(this))}onClick(e){"slideshow"===e.type&&window.DARLA&&!window.DARLA.inProgress()&&window.DARLA.event("slideshow")}getAdBlockConfig(){if(!this.config)return;const e=JSON.parse(JSON.stringify(this.config));let t=e.viewerPositionMeta.positions;const i=e.strings?.advertisement||"Advertisement";e.viewerViewportAdFetch?.slots&&e.viewerViewportAdFetch.slots[0]?.positions?.length&&(e.viewerViewportAdFetch.slots.forEach((e=>{e.positions?.length&&(t=t.concat(e.positions))})),e.viewerViewportAdFetch.slots=[]),e.viewerPositionMeta.positions=t.filter((t=>e.viewerPositionMeta?.enableUBAMON?!(t.id.startsWith("INARTICLE")||t.id.startsWith("MAST")||t.id.startsWith("FSRVY")||t.id.startsWith("LREC4")):!(t.id.startsWith("INARTICLE")||t.id.startsWith("MAST")||t.id.startsWith("MON")||t.id.startsWith("MON2")||t.id.startsWith("FSRVY")||t.id.startsWith("LREC4"))));for(const t of e.viewerPositionMeta.positions){const s=document.getElementById(t.clean),n=document.getElementById(t.dest),o=-1!==D.indexOf(t.id);if(o&&s){const e=s.parentElement;if(e&&e.id.endsWith("-base"))continue}if(s&&s.parentNode&&n){o||(t.id="UBA"+t.id,t.clean=t?.clean?.replace("-","-UBA"),t.dest=t?.dest?.replace("-","-UBA"));const a=document.createElement("div");if(a.id="viewer-"+t.id+"-base",a.style.width="100%",a.className="uba-container",s.id=t.clean,n.id=t.dest,s.parentNode.insertBefore(a,s),a.appendChild(s),!e.viewerPositionMeta?.enableUBAMON){const e=document.createElement("span");e.innerText=i,e.style.color="#787d82",e.style.display="block",e.style.fontSize="11px",e.style.marginBottom="3px",e.style.marginLeft="auto",e.style.marginRight="auto",t.id.indexOf("LDRB")>=0?e.style.width="728px":e.style.width="100%",a.insertBefore(e,s)}}}return e}getConfig(){return document.cookie.includes("thamba=2")?this.getAdBlockConfig():this.config}onViewerClosed(){const{DARLA:e}=window;e&&(e.inProgress()&&e.abort(),this.config?.viewerResetAutoEventOnClose&&this.darlaAutoEvent?.ps&&e.add(M,this.darlaAutoEvent),this.rotateIndexPageAds&&e.event("adFetch")),this.onScrollHandle&&(window.wafer.removeListener("scroll",this.onScrollHandle),this.onScrollHandle=null),window.wafer.state={enableYieldAds:"wf-state-reset",postArticleAdEnabled:"wf-state-reset",publisherBlobPageContext:"wf-state-reset",viewerMainArticleBucket:"wf-state-reset",viewerMainArticleContentSite:"wf-state-reset",viewerMainArticlePubBlob:"wf-state-reset",viewerMainArticleSiteAttribute:"wf-state-reset",viewerMainArticleSpaceId:"wf-state-reset",viewerMainArticleTickers:"wf-state-reset"},document.body.classList.remove("hideAllAds")}onviewerScrollRestored(){const{benji:e}=window;this.enableGAMAds&&e&&(e.destroy("viewer"),(()=>{const{benji:e}=window,t=e?.config?.i13n;if("function"==typeof e?.updateI13N&&t){const i=n;e.updateI13N(t,i)}})(),e.refresh("index",{checkViewport:!0}))}isEligibleLightbox(e){return!!T.find((function(t){return e.getElementsByClassName(t)[0]}))}onArticleInview(e){b(e,this.site)}onLightboxOpen(e){const{DARLA:t}=window;t&&this.isEligibleLightbox(e.elem)&&t.stopAuto()}onLightboxClose(e){const{DARLA:t}=window;if(t&&this.isEligibleLightbox(e.elem)){if(!t.inProgress()){const e=t.evtSettings(M),i=Object.keys(e.ps||{}).filter((e=>{const i=t.posSettings(e)||{};return this.isAdPositionInViewport(i,.5)}));i.length&&(this.addViewportDarlaEvent(i),t.event(this.viewportEvent))}t.startAuto()}}addPosition(e){const t=[];let i=window.location.protocol+"//"+window.location.host;window.location.pathname&&(i+=window.location.pathname);for(const s of e)t.push(s.id),s.meta||(s.meta={}),s.meta.hostURL=i,window.DARLA.addPos(s);return t}addViewportDarlaEvent(e){window.DARLA?.add(this.viewportEvent,{groups:this.config.viewerPositionMeta.groupRotation,name:this.viewportEvent,ps:e.join(","),ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId,ult:y(this.contentSite)})}onPreParseAds(e){if(this.shouldHideAllAds(e))return void document.body.classList.add("hideAllAds");const t=this.getConfig();if(!window.DARLA||!t)return;const i=(t?.viewerPositionMeta?.positions||[]).find((e=>"WIDGETA"===e.id));if(i){const e=document.querySelector("#content-articles-wrapper .caas-share-section")?.clientWidth||0,t=document.getElementById(i.clean);t&&Object.assign(t.style,{marginLeft:`${e}px`,textAlign:"left"})}}isYieldAdEnabled(e){const t=e.meta.data.showYieldAds||!1;return!(!this.enableYieldAds||!t)}shouldHideAllAds(e){const{meta:{data:{hideAllAds:t=!1}={}}={}}=e;return t}displayAds(e){const{benji:t}=window,i=e.meta.data;if(this.shouldHideAllAds(e))return;const s=this.getConfig(),n=i.adMeta;this.contentSite=n?.site||"",this.spaceId=i.spaceId;const o=s?.viewerGAMPositionMeta;if(this.enableGAMAds&&o?.positions&&t){b(e,this.site);const i=C(e,o.positions,this.site);return void t.render(i)}if(this.isYieldAdEnabled(e))return;if(!window.DARLA||!s)return;window.DARLA.inProgress()&&window.DARLA.abort();let a=[],r=n?.site_attribute||"";const c=this.pageContext.bucket||this.pageContext.bucketId,d=c?"Y-BUCKET="+c:"";r.indexOf("page_template")<0&&(r+=" page_template=modal"),this.pageContext.partner&&B[this.pageContext.partner]&&(r+=" cobrandname="+B[this.pageContext.partner]),this.siteAttribute=s.viewerPositionMeta.siteAttributes+" "+r+" "+d;const l=JSON.parse(JSON.stringify(s.viewerPositionMeta.positions));let h=[];if(s.viewerPositionMeta&&(h=this.addPosition(l)),s.viewerViewportAdFetch?.slots&&s.viewerViewportAdFetch.slots[0]?.positions?.length&&(this.viewportAdPositions=s.viewerViewportAdFetch.slots.map((e=>({...e,fetched:!1}))),this.viewportAdPositions.forEach((e=>{a=a.concat(this.addPosition(e.positions))}))),this.isViewportAdFetchEnabled()&&a.length?(this.onScrollHandle=this.handleScrollEvent.bind(this),window.wafer.on("scroll",this.onScrollHandle)):h=h.concat(a),window.DARLA.add(this.event,{name:this.event,ps:h.join(","),ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId,ult:y(this.contentSite)}),window.DARLA.add("slideshow",{name:"slideshow",ps:s.viewerPositionMeta.slideshowPositions,ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId,ult:y(this.contentSite)}),!document.cookie.includes("thamba=2")){window.DARLA.stopAuto();const{customAutoRotation:e}=s.viewerPositionMeta,t=this.hasCustomAutoRotation(e)?e.autoRT:1e4,i={autoDDG:1,autoIV:1,autoMax:25,autoRT:1e4,autoStart:1,name:M,ps:h.concat(a).reduce(((e,i)=>(R.includes(i)||(e[i]={autoIV:1,autoMax:25,autoRT:t}),e)),{}),ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId,ult:y(this.contentSite)};this.config.viewerPositionMeta.groupRotation&&(i.groups=this.config.viewerPositionMeta.groupRotation),this.darlaAutoEvent=window.DARLA.evtSettings(M),window.DARLA.add(M,i),window.DARLA.startAuto()}window.DARLA.event(this.event)}onContentChange(){const{benji:e}=window;e&&e.destroy("viewer")}getViewerMainArticleTickers(e,t){let i="";if(e.length){const t=[];e.forEach((e=>{const i=e.secondaryIds?.stock_symbol;"TICKER"===e.type&&i&&t.push(i)})),t.length>0&&(i=t.join(","))}return i||-1===t.indexOf("ticker=")||(i=t.match(/ticker="([^"]*)"/)?.[1].split(";").slice(0,6).join(",")),i||" "}setWaferState(e){const{elem:n}=e,{adMeta:o,commentsAllowed:a,salientEntities:r,spaceId:c}=e.meta.data,d=this.getConfig(),h=d?.viewerGAMPositionMeta;let p;this.enableGAMAds&&h&&(p=((e,t,i)=>{const s=t?.postArticle?.positions;let n;return s&&(n=C(e,s,i)),JSON.stringify({positions:n})})(e,h,this.site));const m=!!a&&!this.shouldHideAllAds(e),u=function(e,n={}){const{site_attribute:o,yctIds:a}=e,r=l(n?.elem),c=w();if(o){const e=o.match(t);if(e.length>=2){const t={};if(n.enableAdditionalPageContextParams){const e=o.split('" ').reduce(((e,t)=>{const[i,s]=t.split("=");return i&&s&&(s.endsWith('"')?e[i]=s.substring(1,s.length-1):e[i]=s.substring(1)),e}),{});s.forEach((i=>{e[i]&&(t[i]=e[i])}))}const d=e[1].split(";");for(let e of d)e=e.split(":"),e.length>=2&&i[e[0]]&&(t[i[e[0]]]=e[1]);return a&&(t.yctIds=a),r&&(t.pageContentPosition=`${r}`),c&&(t.bucket=c),t}}return null}(o,{elem:n,enableAdditionalPageContextParams:this.enableAdditionalPageContextParams});let f=" ";this.viewerAdsConfig.enableTickersWaferState&&(f=this.getViewerMainArticleTickers(r,o.site_attribute));const g=JSON.stringify(u),v=this.pageContext.bucket||this.pageContext.bucketId||"";window.wafer.state={benjiMeta:p,enableYieldAds:this.isYieldAdEnabled(e),postArticleAdEnabled:m,publisherBlobPageContext:encodeURIComponent(g),viewerMainArticleBucket:encodeURIComponent(v+""),viewerMainArticleContentSite:this.contentSite,viewerMainArticlePubBlob:g.replace(/\"/g,'\\"'),viewerMainArticleSiteAttribute:encodeURIComponent(this.siteAttribute),viewerMainArticleSpaceId:parseInt(c,10),viewerMainArticleTickers:f}}updateWaferStateInView(e){const t=!!e.meta.data.commentsAllowed&&!this.shouldHideAllAds(e);window.wafer.state={postArticleAdEnabled:t}}getPendingViewportAdSlotIndex(){const e=[];return this.viewportAdPositions.forEach(((t,i)=>{t.fetched||e.push(i)})),e}getPositionsAndMarkSlot(){let e=[];return this.viewportAdFetchSlotIndex.forEach((t=>{this.viewportAdPositions[t]?.positions?.length&&(e=e.concat(this.viewportAdPositions[t]?.positions.map((e=>e.id))),this.viewportAdPositions[t].fetched=!0)})),e}isViewportAdFetchEnabled(e=!0){const t=this.config;if(!this.contentSite||!t||e&&document.cookie.includes("thamba=2"))return!1;if(t.viewerViewportAdFetch?.slots&&t.viewerViewportAdFetch.slots[0]?.positions?.length){return-1!==(t.viewerViewportAdFetch?.sites||[]).indexOf(this.contentSite)}return!1}isAdPositionInViewport(e,t=0){const i=document.getElementById(e.clean);if(i){let e={};return t&&(e={offsetX:-i.clientWidth*t,offsetY:-i.clientHeight*t}),window.wafer.utils.elementInView(i,e,window.wafer.base.viewport)}return!1}isAdPositionsInViewport(e){let t=!1;return e.forEach((e=>{t=t||this.isAdPositionInViewport(e)})),t}isSlotPositionsInViewport(e){let t=!1;return e.forEach((e=>{const i=this.viewportAdPositions[e]?.positions,s=i&&this.isAdPositionsInViewport(i);s&&!this.viewportAdFetchSlotIndex.includes(e)&&this.viewportAdFetchSlotIndex.push(e),!t&&s&&(t=!0)})),t}displayViewportAds(){if(window.DARLA){const e=window.DARLA.evtSettings(this.event),t=this.getPositionsAndMarkSlot();if(!t.length)return;e&&(e.ps=`${e.ps},${t.join(",")}`,window.DARLA.add(this.event,e)),this.addViewportDarlaEvent(t),this.viewportPreviousAdFetchSlotIndex=this.viewportAdFetchSlotIndex,this.viewportAdFetchSlotIndex=[],window.DARLA.event(this.viewportEvent)}}delayFetchAds(e,t=2){if(!e)return;let i=1;const s=setInterval((()=>{i>t?(clearInterval(s),window.DARLA?.inProgress()&&(window.DARLA.abort(),e())):window.DARLA&&!window.DARLA.inProgress()&&(clearInterval(s),e()),i++}),500)}onScrollViewportFetch(){const e=this.getPendingViewportAdSlotIndex();if(this.onScrollHandle&&!e.length&&(window.wafer.removeListener("scroll",this.onScrollHandle),this.onScrollHandle=null),!this.isSlotPositionsInViewport(e))return;const t=window.DARLA?.inProgress();t?t!==this.event?(window.DARLA?.abort(),t===this.viewportEvent&&this.viewportPreviousAdFetchSlotIndex.length&&(this.viewportPreviousAdFetchSlotIndex.forEach((e=>{this.viewportAdFetchSlotIndex.includes(e)||this.viewportAdFetchSlotIndex.push(e)})),this.viewportPreviousAdFetchSlotIndex=[]),this.displayViewportAds()):this.delayFetchAds(this.displayViewportAds):(this.viewportPreviousAdFetchSlotIndex=[],this.displayViewportAds())}handleScrollEvent(){"function"==typeof requestAnimationFrame?(this.scrollAnimationFrameTimer&&cancelAnimationFrame(this.scrollAnimationFrameTimer),this.scrollAnimationFrameTimer=requestAnimationFrame((()=>{this.onScrollViewportFetch()}))):this.onScrollViewportFetch()}hasCustomAutoRotation(e){return void 0!==e}},new class{constructor(){this.pageContainer="atomic",this.viewerContainer="viewer",this.aft2MaxWaitTime=6e3}init(e){e?.yaft&&(e.yaft.pageContainer&&(this.pageContainer=e.yaft.pageContainer),e.yaft.viewerContainer&&(this.viewerContainer=e.yaft.viewerContainer),e.yaft.aft2MaxWaitTime&&(this.aft2MaxWaitTime=e.yaft.aft2MaxWaitTime))}onViewerOpened(){this.onTransitionStart(this.viewerContainer)}onContentChange(){this.onTransitionRenderStart()}onViewerClosed(){this.onTransitionStart(this.pageContainer)}onViewerDidClose(){this.onTransitionRenderStart()}onTransitionStart(e){const{YAFT:t}=window;t&&t.AFT2&&(t.AFT2.start(),t.updateConfig({maxWaitTime:this.aft2MaxWaitTime,modulesAft2Container:e}),t.adPosLoadTimes=[])}onTransitionRenderStart(){const{rapidInstance:e,YAFT:t}=window;e&&t&&t.AFT2&&t.AFT2.end(((t,i)=>{if(i)return;const s=Math.round(t.aft),n=t.visuallyComplete,o={perf_commontime:{afterPageLoad:{AFT:s,AFT2:s,STR:Math.round(t.startRender),VIC:n}}};e.beaconPerformanceData(o)}))}},new class{constructor(){this.logCaasEvent=e=>{window.wafer.on(e,(t=>{const i=t.meta||{},s=`/${this.infoBeaconUri}?error=${e}&meta=${JSON.stringify(i)}`;window.wafer.utils.fireBeacon(s,{useNavigator:!1,useTimestamp:!1})}))};const{apptype:e,bucket:t,rid:i}=window.YAHOO?.context??{};this.context={apptype:e,bucket:t,client:"1",rid:i}}init(e){e&&(this.site=e.context?.site||"fp"),this.infoBeaconUri=m(this.site);const t=this.beaconPageView.bind(this);window.wafer.on("caas:article:inview",t),window.wafer.on("caas:article:init",t),window.wafer.on("log",this.beaconLog.bind(this)),this.logCaasEvent("caas:prefetch:failed")}onClick(e){"article"===e.type&&(this.uuid=e.payload.uuid,this.t0=Date.now())}async onContentWillChange(){this.t1=Date.now()}async onContentChange(){this.t2=Date.now()}async onContentDidChange(){this.t3=Date.now(),this.beaconClk2Cnt()}onViewerOpened(){this.beacon({beaconType:"homepage_viewer",info:"show_viewer"})}onViewerClosed(){this.beacon({beaconType:"homepage_viewer",info:"close_viewer"})}beaconLog({meta:e,name:t}={}){if("WaferCaas"===t||"BrowserType"===t&&e.slow){const t=`/${this.infoBeaconUri}?error=log&meta=${JSON.stringify(e)}`;window.wafer.utils.fireBeacon(t,{useNavigator:!1,useTimestamp:!1})}}beaconPageView(e){const t=new Image,i=new URL("/pageview",window.location.origin),s=e.meta.data.adMeta?.site;i.search=p({...this.context,property:s}),t.src=i.toString()}beaconClk2Cnt(){this.beacon({code:"homepage_viewer_clk2cnt",t0:this.t0,t1_t0:Math.floor(this.t1-this.t0),t2_t1:Math.floor(this.t2-this.t1),t3_t2:Math.floor(this.t3-this.t2),time:Math.floor(this.t3-this.t0),uuid:this.uuid})}beacon(e){(new Image).src=`/${this.infoBeaconUri}?${p({...e,meta:JSON.stringify({connection:u(),...h()})})}`}},new class{constructor(e){this.className=e.targetClassName,this.closeButton=document.getElementById("closebtn"),this.clusters=[],this.clusterSize=e.clusterSize,this.headerAnchorId="",this.home=new URL(location.href),this.isViewerClosed=!0,this.ntkClusterSize=e.ntkClusterSize,this.tagName=e.targetTagName,this.site="fp"}init(e){const t=e?.clickHandler;if(t){const{clusterSize:e,ntkClusterSize:i}=t;e&&(this.clusterSize=e),i&&(this.ntkClusterSize=i)}e?.context&&(this.site=e.context.site);const i=this.handleClick.bind(this);let s=document.getElementById("header-logo");s?this.headerAnchorId="header-logo":(s=document.getElementById("_yb_bbtn"),s?this.headerAnchorId="_yb_bbtn":(s=document.getElementById("ybar-logo"),s&&(this.headerAnchorId="ybar-logo")));const n=this.handleCaaSClickLink.bind(this);document.body.addEventListener("click",i,{capture:!0}),window.wafer.on("caas:link:clicked",n),window.wafer.on("caas:yahooLink:clicked",n),this.viewerNode=document.getElementById("viewer")}getArticles(e,t){const i={},s=!e.classList.contains("article-cluster-cycle-off"),n=e.querySelectorAll("[data-wf-caas-uuid]"),o=[],a=[];let r=!1;for(const e of n){const i=e.getAttribute("data-wf-caas-uuid");if(i===t){r=!0;continue}const n=e.getAttribute("data-wf-caas-prefetch-group"),d=e.getAttribute("href")||"",l=c(d),h=l.includes("/sports/");"prestige"===n&&h||i&&l&&(r?a.push({pathname:l,uuid:i}):s&&o.push({pathname:l,uuid:i}))}return a.concat(o).forEach((({pathname:e,uuid:t})=>{i[t]={pathname:e,uuid:t}})),i}onViewerClosed(){this.clusters=[],this.isViewerClosed=!0}onViewerWillOpen(){this.home=new URL(location.href)}onViewerOpened(){this.isViewerClosed=!1;var e=this;setTimeout((function(){e.closeButton=e.closeButton||document.getElementById("closebtn"),e.closeButton?.focus()}),500)}getElementComposedMap(e){let t=e;const i=new Map;for(;t;)i.set(t,!0),t=t.parentElement;return i}getClusterSize(e){return 0===Math.max(this.clusterSize,this.ntkClusterSize)?0:r(e,{className:"ntktdv2"})||r(e,{id:"module-ntk"})?this.ntkClusterSize:r(e,{className:"yns-notifications"})?0:this.clusterSize}handleCaaSClickLink(e){const t=e.meta.data;if(t.isComment){const e=t.uuid;return this.dispatch(I,{payload:{uuid:e},type:"comments"})}const{sec:i}=t;if(t.href){const{pos:e,slk:s}=t;this.dispatch(I,{payload:{pos:e,ylk:Object.assign({sec:i,slk:s},t.params)},type:"photo-select"===s?"slideshow":"link"});const n=window.open(t.href,t.target);n&&(n.opener=null)}else if(i){const{pos:e,sec:i,slk:s}=t;this.dispatch(I,{payload:{pos:e,ylk:Object.assign({sec:i,slk:s},t.params)},type:"sshow"===i?"slideshow":"link"})}}handleClick(e){if(!g(window,"wafer.wafers.wafer-caas"))return;const t=e.target,i=t&&t.id;if(!this.isViewerClosed){if(t.classList.contains("view-spotim-cmnts-btn")){e.preventDefault();const i=r(t,{className:"view-spotim-cmnts-btn-container"});if(i)return t.parentNode?.removeChild(t),this.dispatch(I,{payload:{id:i.getAttribute("id"),uuid:i.getAttribute("data-uuid")},type:"viewSpotIm"});const s=r(t,{className:"community-bar-fixed"})?.getAttribute("id")||r(t,{className:"community-bar-wrapper"})?.getAttribute("id");if(s)return this.dispatch(I,{payload:{id:s,uuid:t.getAttribute("data-id")},type:"viewSpotIm"})}if(r(t,{id:"header-back-button",tagName:"A"}))return e.preventDefault(),e.stopPropagation(),this.dispatch(I,{type:"back"});if(this.headerAnchorId&&r(t,{id:this.headerAnchorId,tagName:"A"}))return e.preventDefault(),e.stopPropagation(),this.dispatch(I,{type:"close"});const s=r(t,{id:"closebtn",tagName:"BUTTON"});if(s){let e={};return s.getAttribute("data-close-source")&&(e=window.wafer.utils.getYlkMapForNode(s,"data-ylk")),this.dispatch(I,{type:"close",ylk:e})}if("Overlay"===i)return this.dispatch(I,{type:"overlay"})}const s=r(t,{className:this.className,tagName:this.tagName});if(s){if(e.ctrlKey||e.metaKey)return;"function"==typeof e.preventDefault&&e.preventDefault();const t=e.target.classList.contains("spotim-comments-button")||!!r(e.target,{className:"js-stream-comments-button"}),i=s.getAttribute("href")||"",n=!!window.MSInputMethodContext&&!!document.documentMode,o=window.React,a="prestige"===s.getAttribute("data-wf-caas-prefetch-group");if(n&&o&&("finance"===this.site||"sports"===this.site)||a)return void(window.location.href=i);const d=c(i),l=this.getClusterArticles(s),h=f(s),w={cluster:l,expandComments:t,isHpViewer:!0,pathname:d,refererUrl:window.location.href,uuid:h};this.dispatch(I,{payload:w,type:"article"})}else{if(t.classList.contains("spotim-comments-button")){const e=t.getAttribute("data-uuid");this.dispatch(I,{payload:{id:"spotIm-conversations-module-wrapper",loadSpotImJS:!0,uuid:e},type:"viewSpotIm"})}if(t.classList.contains("view-cmts-cta")){const e=t.getAttribute("data-uuid");this.dispatch(I,{payload:{loadSpotImJS:!0,uuid:e},type:"viewSpotIm"})}}const n=this.getElementComposedMap(t);if(this.viewerNode&&n.has(this.viewerNode)){const e=document.getElementById("content-viewer");if(e&&!n.has(e))return this.dispatch(I,{type:"close"});const t=this.viewerNode.getElementsByClassName("viewer-wrapper")[0];if(t&&!n.has(t))return this.dispatch(I,{type:"close"})}}getClusterArticles(e){const t=e.getAttribute("data-wf-caas-prefetch-group"),i=this.getClusterSize(e);if(0===i||"prestige"===t)return[];const s=r(e,{className:"article-cluster-boundary"}),n=s||r(e,{className:"drawer-fetch-target",tagName:"DIV"})||r(e,{className:"stream-item",tagName:"LI"})||r(e,{className:"js-stream-content",tagName:"LI"})||r(e,{className:"module-ntk",tagName:"DIV"})||r(e,{className:"react-wafer-ntk-desktop",tagName:"DIV"})||r(e,{className:"aside-sticky",tagName:"DIV"})||r(e,{id:"Page"});if(!n)return[];let o=e.getAttribute("data-wf-caas-uuid")||e.getAttribute("data-uuid")||"";if(!o){const t=r(e,{className:"js-stream-content",tagName:"LI"});o=t&&(t.getAttribute("data-wf-caas-uuid")||t.getAttribute("data-uuid"))||""}const a=this.getArticles(n,o);if(!s){let e=n.nextElementSibling;for(;Object.keys(a).length<i&&e;)Object.assign(a,this.getArticles(e,o)),e=e.nextElementSibling;let t=n.previousElementSibling;for(;Object.keys(a).length<i&&t;)Object.assign(a,this.getArticles(t,o)),t=t.previousElementSibling}return this.clusters=Object.values(a).slice(0,i),this.clusters}}({clusterSize:2,ntkClusterSize:5,targetClassName:"js-content-viewer",targetTagName:"A"}),new class{constructor(e){this.isEnabled=!0;const t=h();this.comments={},this.config=e,this.expanded=!1,this.region=t?.region||"US",this.lang=t?.lang||"en-US",this.site="fp"}init(e){const t=document.getElementById("spotim-config"),i=t&&window.wafer.utils.getConfigFromJSONScriptNode(t)||{};if(e?.spotIm?.enabled||i?.enabled)return void(this.isEnabled=!1);if(e?.comments&&!e.comments.enabled)return void(this.isEnabled=!1);e?.context&&(this.region=e.context.region,this.lang=e.context.lang,this.site=e.context.site);const s=this.initCommentsOnView.bind(this);window.wafer.on("caas:article:inview",s),window.wafer.on("caas:article:init",s)}async onContentChange(e){this.expanded=e.expandComments}async onClick(e){if(this.isEnabled&&"comments"===e.type){const t=e.payload.uuid,i=this.comments[t]||await this.initCommentsOnClick(t);if(i&&i.instance){i.instance.expand(),await a(100);document.getElementById(i.id).scrollIntoView({behavior:"smooth"})}}}onViewerDidClose(){Object.values(this.comments).forEach((e=>{e.instance?.destroy()})),this.comments={},this.expanded=!1,document.documentElement.classList.remove("comments-expanded")}getCommentsNodeId(e){const t=window.wafer.base._state;for(const i of Object.getOwnPropertyNames(t)){if(t[i]===e){const e=document.querySelector(`[data-wf-state-caas-uuid="[state.${i}]"]`);if(e){return e.getAttribute("data-comments-id")}}}}getRapidBucket(){return window.rapidPageConfig?.rapidConfig?.test_id||""}getRapidKeys(){return window.rapidInstance?window.rapidInstance.getRapidAttribute("keys"):{}}getRapidSpaceId(){return window.rapidInstance?window.rapidInstance.getRapidAttribute("spaceid"):""}getCanvassCommentsParams(e){const{commentSectionId:t,hostedType:i,spaceId:s,title:n,url:o,uuid:a}=e,r="hosted"===i?"yahoo_content":"yahoo_offnet",c=this.getRapidKeys(),d=s||this.getRapidSpaceId(),{_rid:l}=c,h=this.site||"fp",{device:w}=this.config,p="news"===this.site?"redesign":"",m="news"===this.site?"Ff(YahooSans)":"";return{bucket:this.getRapidBucket(),context:a,contextDisplayText:n,contextUrl:o,device:w,lang:this.lang,namespace:r,onCollapsed(){document.documentElement.classList.remove("comments-expanded")},onExpanded(){document.documentElement.classList.add("comments-expanded")},prid:l,rapid:window.rapidInstance,rapidKeys:c,region:this.region,sectionId:t,site:h,spaceid:d,theme:p,themeContainerClasses:m,useRelativeHostName:!0}}initComments(e,t,i){const{CanvassComments:s}=window.YAHOO,{rmp:n}=this.config;if(!n){if(!s)return;const n=new s(t,i);return this.expanded=!1,this.comments[e]={id:t,instance:n}}{const s=document.getElementById(t);if(!s)return;this.comments[e]={id:t};const o=`${n.xhrPathPrefix}?m_id=${n.m_id}&ctrl=${n.ctrl}&m_mode=json&rid=${i.prid}&context=${e}&device=${i.device}&site=${i.site}&region=${i.region}&lang=${i.lang}`,a=n.config?`data-wf-body=${JSON.stringify(n)}`:"";s.innerHTML=`<div class="wafer-fetch" data-wf-trigger="onLoad" data-wf-cache-strategy="cacheFirst" data-wf-replace="1" data-wf-url="${o}" ${a}></div>`,window.wafer.base.sync(s)}}initCommentsOnView(e){if(!window.YAHOO)return;const t=e.meta.data,i=t.uuid;if(!t.commentsAllowed)return;if(this.comments[i])return;const s=e.elem.getAttribute("data-comments-id"),n=this.getCanvassCommentsParams(t);n.expanded=this.expanded,this.initComments(i,s,n)}async initCommentsOnClick(e){const[t]=await window.wafer.caas.getData([e]);if(!t.commentsAllowed)return;const i=this.getCanvassCommentsParams(t);i.expanded=!0;const s=this.getCommentsNodeId(e);return s?this.initComments(e,s,i):void 0}}({device:"desktop",rmp:{config:{ui:{enableFeedback:!1}},ctrl:"CanvassMessage",m_id:"tdv2-applet-canvass.message",m_mode:"json",xhrPathPrefix:"/nel_ms/_td/remote"}}),new class{onViewerDidClose(){dispatchEvent(new CustomEvent("viewerClosed"))}onViewerOpened(e){const t={detail:{uuid:e.uuid}};dispatchEvent(new CustomEvent("viewerOpened",t))}onContentChange(e){const t={detail:{uuid:e.uuid}};dispatchEvent(new CustomEvent("viewerContentChanged",t))}},new class{init(){this.shouldDeeplink=!document.getElementById("content-viewer-template")}onClick(e){this.shouldDeeplink&&"article"===e.type&&e.payload?.pathname&&(window.location.pathname=e.payload.pathname)}},new class{constructor(){this.disableMainViewStyleForLockingViewerOpenOrClose=!1,this.enableAPISeamlessModal=!1}init(e){this.enableAPISeamlessModal=e?.enableAPISeamlessModal||!1,this.mainView=document.getElementById("Masterwrap")||document.getElementById("MainView")||document.getElementById("YDC-Col1")?.parentElement||document.querySelector('[data-mainview="1"]'),this.viewer=document.getElementById("content-viewer"),this.viewerParent=document.getElementById("viewer"),this.viewerConfig=e,this.listener=e=>{27!==e.keyCode||document.body.classList.contains("wafer-lightbox-open")||history.back()},this.disableMainViewStyleForLockingViewerOpenOrClose=e?.disableMainViewStyleForLockingViewerOpenOrClose||!1,window.wafer.on("caas:article:init",this.setWaferState.bind(this)),e?.enableSetPublisherId&&window.wafer.on("caas:article:pre:inview",this.setWafetStatePublisher.bind(this))}onContentWillChange(){window.wafer.state={showViewer:Date.now()}}setWaferState(e){const t=e.meta.data.entities||{},i=e.meta.data.providerId&&Array.isArray(e.meta.data.providerId)?e.meta.data.providerId[0]:"",s=e.meta.data.editorialPicksList,n=this.viewerConfig;window.wafer.state={...n?.enableFanShopModal&&{contentEntities:JSON.stringify(t).replace(/\"/g,'\\"')},...n?.enableSeamlessProgramming&&{viewerMainArticleListId:s||" "},...n?.enableSetPublisherId&&{viewerMainArticlePublisher:i}}}setWafetStatePublisher(e){for(let t=1;t<7;t++){const i=e.meta.data.providerId&&Array.isArray(e.meta.data.providerId)?e.meta.data.providerId[0]:"";if(window.wafer.base.state[`viewerClusterArticleId${t}`]===e.meta.data.uuid){window.wafer.state={[`viewerClusterArticlePublisher${t}`]:i};break}}}async onContentChange(e){const{cluster:t=[],uuid:i}=e,s=t.map((e=>e.uuid));this.viewer.classList.remove(...[0,1,2,3,4,5,6].map((e=>`cluster${e}`))),this.viewer.classList.add(`cluster${t.length}`),await a(1);const n={viewerClusterArticleId1:s[0],viewerClusterArticleId2:s[1],viewerClusterArticleId3:s[2],viewerClusterArticleId4:s[3],viewerClusterArticleId5:s[4],viewerClusterArticleId6:s[5],viewerClusterArticleIds:s,viewerMainArticleId:i};this.enableAPISeamlessModal?(window.wafer.state={viewerMainArticleId:i},window.wafer.on("error",(e=>{"WaferFetch"===e.name&&"viewerContentUuids"===e.elem.id&&(window.wafer.state=n)}))):window.wafer.state=n,await a(1)}async onViewerOpened(){if(window.wafer.base.lock(this.mainView),this.mainView.setAttribute("aria-hidden","true"),!this.disableMainViewStyleForLockingViewerOpenOrClose){const{left:e,top:t}=this.mainView.getBoundingClientRect();Object.assign(this.mainView.style,{left:e+"px",position:"fixed",top:t+"px",visibility:"hidden"})}this.viewerParent?.setAttribute("aria-hidden","false"),document.documentElement.classList.add("modal-open","Panel-open","viewer-open"),await a(5),window.addEventListener("keydown",this.listener)}onViewerClosed(){this.viewerParent?.setAttribute("aria-hidden","true"),this.mainView.style.visibility="",this.viewer.classList.remove("wafer-template-success"),window.wafer.base.destroy(this.viewer),this.viewer.innerHTML="",document.documentElement.classList.remove("modal-open","Panel-open","viewer-open"),this.mainView.removeAttribute("aria-hidden"),this.disableMainViewStyleForLockingViewerOpenOrClose||Object.assign(this.mainView.style,{left:"",position:"",top:""}),window.wafer.base.unlock(this.mainView),window.wafer.base.sync(this.mainView),window.removeEventListener("keydown",this.listener),window.wafer.state={publisherBlobPageContext:"wf-state-reset",showViewer:"wf-state-reset",viewerClusterArticleId1:"wf-state-reset",viewerClusterArticleId2:"wf-state-reset",viewerClusterArticleId3:"wf-state-reset",viewerClusterArticleId4:"wf-state-reset",viewerClusterArticleId5:"wf-state-reset",viewerClusterArticleId6:"wf-state-reset",viewerClusterArticlePublisher1:"wf-state-reset",viewerClusterArticlePublisher2:"wf-state-reset",viewerClusterArticlePublisher3:"wf-state-reset",viewerClusterArticlePublisher4:"wf-state-reset",viewerClusterArticlePublisher5:"wf-state-reset",viewerClusterArticlePublisher6:"wf-state-reset",viewerMainArticleId:"wf-state-reset",viewerMainArticleListId:"wf-state-reset",viewerMainArticlePubBlob:"wf-state-reset",viewerMainArticlePublisher:"wf-state-reset",viewerMainArticleSpaceId:"wf-state-reset",viewerMainArticleTickers:"wf-state-reset"}}},new class{constructor(){this.count="12",this.sidekickUrl=this.getSidekickUrl(),this.clusterUuids=[]}init(e){if(e.rightRail?.disableSidekick)return;this.config=e;const t=this.initSidekick.bind(this);window.wafer.on("caas:article:init",t)}async onContentChange(e){window.wafer.state={sidekick:"wf-state-reset"};const{cluster:t=[]}=e;this.clusterUuids=[];for(const e of t)e.uuid&&this.clusterUuids.push(e.uuid)}onViewerClosed(){window.wafer.state={sidekick:"wf-state-reset"}}isLongArticle(e){return"hosted"===e.hostedType&&"slideshow"!==e.contentType&&"video"!==e.contentType}getSidekickUrl(){const e=v()?location.origin:"https://www.yahoo.com",t=new URL(e);return t.pathname="/caas/sidekick/sidekick",t}initSidekick(e){const{spaceId:t,uuid:i,ycts:s}=e.meta.data;let n=i;(async()=>{const e=await window.wafer.caas.getData([i,...this.clusterUuids]),o=e.filter(this.isLongArticle);this.count=o.length>1?"12":"6";let a="";for(const t of e){const{uuid:e}=t;e&&-1===n.indexOf(e)&&(n=`${n},${e}`);const i=g(t,"adMeta.site");i&&(a=a?`${a},${i}`:i)}if(this.config?.enableSidekickNCP){const e={dedupeUuids:n.split(",").filter((e=>e!==i)).toString(),spaceId:t,uuid:i};this.sidekickUrl.search=new URLSearchParams(e).toString()}else{const e={count:this.count,property:a,spaceId:t,uuid:n,ycts:s};this.sidekickUrl.search=new URLSearchParams(e).toString()}window.wafer.state={sidekick:this.sidekickUrl.toString()}})()}},new class{constructor(){this.home=new URL(location.href),this.isViewerClosed=!0,this.navigationFailureInProgress=!1,this.testDisableSetTimeout=!!this.home.searchParams.get("testDisableSetTimeout")}init(e){e&&(this.site=e.context?.site||"fp",e.retainSearchParams&&(this.retainSearchParams=e.retainSearchParams),this.navigationTimeout=e.navigationTimeout),this.infoBeaconUri=m(this.site);const t=document.querySelector('link[rel="canonical"]');t&&(this.canonicalEl=t,this.ogUrlEl=document.querySelector('meta[property="og:url"]'),this.canonicalElStartVal=t.getAttribute("href")),window.addEventListener("popstate",this.onPopState.bind(this)),window.wafer.on("caas:article:init",(()=>{this.dispatch(E,this.payload)})),window.wafer.on("caas:article:inview",(e=>{this.navigateFailureTimeout&&clearTimeout(this.navigateFailureTimeout);const{data:t}=e.meta;let i=t.homepageUrl||t.url;for(const e of[this.payload,...this.payload.cluster])if(e.uuid===t.uuid&&e.pathname){i=e.pathname;break}i!==location.pathname&&this.replaceState(this.payload,i)})),window.wafer.on("caas:article:error",(e=>{const{viewerMainArticleId:t}=window.wafer.base._state,{hasData:i,hasMarkup:s,url:n,uuid:o}=e.meta;o===t?this.onNavigateFailure(n,`fetcherror;hasData:${i};hasMarkup:${s}`):this.onClusterArticleFailure(n)})),window.wafer.on("caas:sidekick:error",(e=>{const t=new Image,i=p({connection:JSON.stringify(u()),error:"sidekick_error",url:e.meta.url});t.src=`/${this.infoBeaconUri}?${i}`})),window.addEventListener("closeHpViewer",(e=>{this.navigateHome({type:"back",ylk:e.detail?.ylk}),this.pushState({},this.home.href)}))}onClusterArticleFailure(e){this.beaconFailure("cluster_article_failure",e)}onNavigateFailure(e,t=""){this.navigationFailureInProgress||(this.navigationFailureInProgress=!0,setTimeout((()=>{if(this.isViewerClosed)return;this.beaconFailure(`navigate_failure${t&&`:${t}`}`,e);let i="";"frontpage"!==this.site&&"fp"!==this.site||(i="?.tsrc=fp_deeplink");let s=`${this.payload.pathname}${i}`;s=A(s),window.location.href=s}),500))}beaconFailure(e,t){const i=new Image,s=p({connection:JSON.stringify(u()),error:e,url:t,...h()});i.src=`/${this.infoBeaconUri}?${s}`}onClick(e){switch(e.type){case"article":const t=e.payload;clearTimeout(this.navigateFailureTimeout),this.navigateFailureTimeout=window.setTimeout((()=>{const e=location.origin+t.pathname;this.onNavigateFailure(e,"timeout")}),this.navigationTimeout||6e3),this.isViewerClosed&&this.dispatch(V),this.navigateToArticle(t),this.pushState(t,t.pathname);break;case"back":this.onHeaderBackButtonClicked();break;case"close":case"overlay":this.navigateHome(e),this.pushState({},this.home.href)}}onViewerWillOpen(){this.home=new URL(location.href)}onViewerClosed(){clearTimeout(this.navigateFailureTimeout)}async navigateToArticle(e){this.payload=e,await this.dispatch(k,e),this.isViewerClosed&&(await this.dispatch(N,e),this.isViewerClosed=!1),await this.dispatch(P,e)}onHeaderBackButtonClicked(){history.back()}async navigateHome(e){if(this.isViewerClosed)return;this.isViewerClosed=!0;const t=this.canonicalElStartVal;t&&(this.canonicalEl?.setAttribute("href",t),this.ogUrlEl?.setAttribute("content",t)),await this.dispatch(L,e),this.testDisableSetTimeout?this.dispatch(O):setTimeout((()=>this.dispatch(O)),0)}async onPopState(){const e=window.history.state||{};window.location.href===this.home.href?await this.navigateHome({type:"back"}):e.isHpViewer&&this.navigateToArticle(e)}getHrefWithQueryParams(e){const t=new URL(e,location.origin);return this.retainSearchParams&&this.retainSearchParams.length&&this.retainSearchParams.forEach((e=>{if(!t.searchParams.has(e)&&this.home.searchParams.has(e)){const i=String(this.home.searchParams.get(e));t.searchParams.append(e,i)}})),t.href}pushState(e,t){history.pushState(e,"",this.getHrefWithQueryParams(t))}replaceState(e,t){history.replaceState(e,"",this.getHrefWithQueryParams(t))}},new class{constructor(e){this.config=e,this.viewerOpen=!1,this.onScroll=this.onScroll.bind(this),this.activeSticky=this.getStickyNode(e.pageStickyNode),this.stickyBottom=e.pageStickyBottom,this.mainBodyNode=document.getElementById("Main")}init(){window.wafer.ready((()=>{"function"==typeof requestAnimationFrame?window.wafer.on("scroll",(()=>requestAnimationFrame(this.onScroll))):window.wafer.on("scroll",this.onScroll)}),window)}onViewerOpened(){this.viewerOpen=!0,this.activeSticky=this.getStickyNode(this.config.viewerStickyNode),this.stickyBottom=this.config.viewerStickyBottom,this.viewerContainerNode=this.getStickyNode(this.config.viewerContainerNode)}onContentDidChange(){this.activeSticky=this.getStickyNode(this.config.viewerStickyNode),this.stickyBottom=this.config.viewerStickyBottom,this.viewerContainerNode=this.getStickyNode(this.config.viewerContainerNode)}onViewerClosed(){this.viewerOpen=!1,this.activeSticky=this.getStickyNode(this.config.pageStickyNode),this.stickyBottom=this.config.pageStickyBottom,this.viewerContainerNode=this.getStickyNode(this.config.viewerContainerNode)}getStickyNode(e){return document.querySelector(e)}onScroll(){if(window.pageYOffset>0?document.body.classList.add("has-scrolled"):document.body.classList.remove("has-scrolled"),this.activeSticky&&this.activeSticky.parentElement){const{bottom:e,height:t}=this.activeSticky.getBoundingClientRect();if(!this.viewerOpen&&this.mainBodyNode&&t>=this.mainBodyNode.offsetHeight)return;const i=this.viewerContainerNode?this.viewerContainerNode.getBoundingClientRect().bottom:0,s="fixed"===this.activeSticky.style.position&&!this.activeSticky.parentElement.classList.contains("sticky-flow");if(t<window.innerHeight)return;if(this.viewerContainerNode&&i<window.innerHeight){const e=window.innerHeight-i+this.stickyBottom;Object.assign(this.activeSticky.style,{bottom:e+"px",position:"fixed"}),this.activeSticky.parentElement.classList.remove("sticky-active"),this.activeSticky.parentElement.classList.add("sticky-flow")}else s?window.pageYOffset<t-window.innerHeight+this.config.rightRailTop&&(Object.assign(this.activeSticky.style,{bottom:"",position:""}),this.activeSticky.parentElement.classList.remove("sticky-active")):e<window.innerHeight&&(Object.assign(this.activeSticky.style,{bottom:this.stickyBottom+"px",position:"fixed"}),this.activeSticky.parentElement.classList.add("sticky-active"),this.activeSticky.parentElement.classList.remove("sticky-flow"))}}get rightRail(){return document.getElementsByClassName("viewer-aside")[0]}}({pageStickyBottom:30,pageStickyNode:"#Aside .aside-sticky",rightRailTop:91,viewerContainerNode:"#content-articles-wrapper",viewerStickyBottom:60,viewerStickyNode:"#viewer-aside .aside-sticky"}),new class{constructor(){this.home=new URL(location.href),this.scrollHistory={}}onContentChange(e){this.restoreScrollPosition(e.pathname)}onViewerWillOpen(){this.home=new URL(location.href),this.saveScrollPosition(this.home.pathname),window.history&&(window.history.scrollRestoration="manual")}onViewerDidClose(){const{pathname:e}=location;this.restoreScrollPosition(e),window.history&&(window.history.scrollRestoration="auto"),dispatchEvent(new CustomEvent("viewerScrollRestored"))}saveScrollPosition(e){this.scrollHistory[e]={x:window.pageXOffset,y:window.pageYOffset}}restoreScrollPosition(e){const{x:t=0,y:i=0}=this.scrollHistory[e]||{};e!==this.home.pathname?setTimeout((function(){window.scrollTo(t,i)}),20):window.scrollTo(t,i)}},new class{constructor(){this.title=document.title,this.ogTitleEl=document.querySelector('meta[property="og:title"]'),this.canonicalEl=document.querySelector('link[rel="canonical"]')}init(){window.wafer.on("caas:article:inview",(e=>{const{title:t,canonicalUrl:i,previewLink:s,hostedType:n,homepageUrl:o}=e.meta.data,a="hosted"!==n&&s||i||o;document.title=t,this.ogTitleEl?.setAttribute("content",t),this.canonicalEl?.setAttribute("href",a)}))}onViewerClosed(){const e=this.title;document.title=e,this.ogTitleEl?.setAttribute("content",e)}},new class{init(e){if(!window.rapidInstance)return;window._comscore=window._comscore||[],this.spaceId=window.rapidInstance.getRapidAttribute("spaceid"),this.referrer=new URL(location.pathname,location.origin).toString();const t=this.beaconPageView.bind(this);window.wafer.on("caas:article:inview",t)}onViewerDidClose(){window.rapidInstance&&this.beaconComscore(this.spaceId)}async beaconPageView(e){const{spaceId:t}=e.meta.data;this.beaconComscore(t)}async beaconComscore(e){const t=new URL(location.pathname,location.origin).toString();window._comscore=window._comscore||[],window._comscore.push({c1:2,c14:window.YAHOO?.comscore?.c14||"-1",c2:"7241469",c5:e,c7:t,c9:this.referrer}),window.COMSCORE?.purge(),this.referrer=t}},new class{constructor(){this.trackedItemsInViewer={}}init(e){e&&(this.meta={assetid:window.location.pathname,section:"Yahoo!",type:"static"}),this.nSdkInstance=window.nSdkInstance,this.nSdkNseNo=window.nSdkNseNo,window.wafer.on("caas:article:inview",(e=>{const t=e.meta.data?.uuid;t&&!this.trackedItemsInViewer[t]&&(this.nielsenSpaEvent("caas:article:inview"),this.trackedItemsInViewer[t]=!0)}))}onViewerOpened(){this.nSdkNseNo=window.nSdkNseNo,this.trackedItemsInViewer={}}onViewerDidClose(){this.trackedItemsInViewer={},this.nielsenSpaEvent("viewerClosed")}nielsenSpaEvent(e){var t=window.location;this.nSdkInstance&&void 0!==this.nSdkNseNo&&this.meta&&(this.nSdkInstance.ggPM("staticend",this.meta),this.nSdkNseNo=++this.nSdkNseNo,this.meta.referrerURL=this.meta.pageURL||t.href,this.meta.pageURL="page_"+this.nSdkNseNo+"_"+t.href,this.meta.assetid=t.pathname,this.nSdkInstance.ggPM("staticstart",this.meta),"viewerClosed"===e&&(window.nSdkNseNo=this.nSdkNseNo))}},new class{init(e){}onClick(e){U&&"article"===e.type&&performance.mark("article_link_clicked")}onViewerClosed(){U&&performance.clearMarks("article_link_clicked")}},new class{constructor(){this.playingVideos=[]}onViewerOpened(){this.playingVideos=[];const e=window.context?.getStore("VideoPlayerStore")?.getVideoPlayers()||[];for(const{player:t}of e)t.controls.isPlaying()&&(this.playingVideos.push(t),t.controls.pause())}onViewerDidClose(){for(const e of this.playingVideos)e.controls.play();this.playingVideos=[]}},new class{constructor(){}init(e){}onClick(e){window.postMessage({action:"y:homepage:click",props:{type:e.type}},"*")}},new class{constructor(e){this.clickToShowComments=!1,this.didMainArticleRender=!1,this.isEnabled=!1,this.isScriptLoaded=!1,this.missedArticleInViewEvents=[],this.reinitCommentsOnEveryView=!1,this.comments={},this.device=e.device,this.didMainArticleRender=!1}async init(e){const t=document.getElementById("spotim-config"),i=t&&window.wafer.utils.getConfigFromJSONScriptNode(t)||{},s=e?.spotIm;if(s&&s?.enabled||i?.enabled){this.isEnabled=!0,this.spotImConfig=e.spotIm||i||{};const t=this.spotImConfig.config||{};if(this.reinitCommentsOnEveryView=t.reinitCommentsOnEveryView||!1,this.clickToShowComments=!!t.enableClickToShowComments,!this.clickToShowComments){const e=this.onArticleInView.bind(this);window.wafer.on("caas:article:inview",e)}window.wafer.on("caas:article:fetch",this.onArticleFetch.bind(this)),window.wafer.on("caas:article:inview",(()=>{this.didMainArticleRender=!0}))}}async loadSpotIm(){return new Promise(((e,t)=>{const i=document.createElement("script");i.async=!0,i.src=this.spotImConfig.spotImJsUrl,i.onload=e,i.onerror=t,document.body.appendChild(i)}))}async onViewerOpened(){this.isEnabled&&this.loadSpotImIfNeeded()}async onContentWillChange(){this.missedArticleInViewEvents=[]}async loadSpotImIfNeeded(){if(!this.isScriptLoaded){try{await this.loadSpotIm()}catch(e){console.error("spotIm js file load error",e)}this.isScriptLoaded=!0,this.processMissedEvents()}}async processMissedEvents(){this.missedArticleInViewEvents.length&&(this.missedArticleInViewEvents.forEach((e=>this.onArticleInView(e))),this.missedArticleInViewEvents=[])}onViewerClosed(){window.wafer.state={currentArticleTitle:"wf-state-reset",currentArticleUrl:"wf-state-reset"}}onViewerDidClose(){Object.values(this.comments).forEach((e=>{e.commentsNode?.remove()})),this.comments={},this.missedArticleInViewEvents=[],this.didMainArticleRender=!1}initShareSection(e,t){const i=document.getElementById(e);if(!i)return;const{url:s,uuid:n,title:o}=t,{config:a,m_id:r}=this.spotImConfig,c="SpotImJACMobileLite",{disableFixedCommunityBar:d=!1,xhrPathPrefix:l}=a,h={...a,title:encodeURIComponent(o),url:s,uuid:n},w=d?document.getElementById(`custom-social-${i.id}`):document.getElementById("custom-social");if(!w)return;const p=`${l}?m_id=${r}&ctrl=${c}&m_mode=json`,m=`data-wf-body=${JSON.stringify({config:h,ctrl:c,m_id:r,m_mode:"json"})}`;w.innerHTML=`<div class="wafer-fetch D(f) Fld(r) Fxw(w)" data-wf-trigger="viewport" data-wf-result-selector=".custom-social"data-wf-url="${p}" ${m}></div>`,window.wafer.base.sync(w)}initComments(e,t,{scrollIntoView:i=!1}={}){let s=document.getElementById(e);if(!s)return;i&&setTimeout((()=>{s.scrollIntoView?.({block:"center"})}),10);const{url:n,uuid:o,title:a,hasCommunityPoll:r}=t,{config:c}=this.spotImConfig,{disableFixedCommunityBar:d=!1}=c,l={...c,title:encodeURIComponent(a),url:n,uuid:r?o+"_TFPOLL":o},h="mainArticleIdComments"===s.id,w="community-bar"===s.id,p=d?`community-bar-wrapper-${s.id}`:"community-bar-wrapper",m=s.parentElement?.id===p,u=h||w;if(w||m){const e=s.getAttribute("data-lightbox-comments-id"),t=e?document.getElementById(e):"";t&&(s=t)}const f={detail:{config:{...l},elem:s,isMain:u}};dispatchEvent(new CustomEvent("initSpotImComments",f)),this.comments[o]={commentsNode:s,id:e};const g=document.querySelector(`.caas-button.view-cmts-cta[data-uuid="${o}"]`);g&&g.remove()}onArticleInView(e){if(!this.isScriptLoaded)return void this.missedArticleInViewEvents.push(e);const{homepageUrl:t,title:i,url:s}=e.meta.data;window.wafer.state={currentArticleTitle:i,currentArticleUrl:t||s},this.initCommentsOnView(e)}onArticleFetch(e){const t=e.meta.data,{commentsAllowed:i,uuid:s}=t,n=document.querySelector(`.view-spotim-cmnts-btn[data-id="${s}"`)||document.querySelector(`.view-spotim-cmnts-btn-container[data-uuid="${s}"`);n&&(i?(n.setAttribute("data-enabled","true"),n?.getElementsByClassName("reaction-count")[0]?.classList.add("caas-dynamic-count")):n?.parentNode?.removeChild(n));const o=e.elem.getAttribute("data-comments-id");o&&this.initShareSection(o,t)}initCommentsOnView(e){if(!window.YAHOO)return;const t=e.meta.data,i=t.uuid,s=document.getElementById("spot-im-wafer-lightbox");if(!t.commentsAllowed){if(!s)return;s.style.display="none"}if(!0!==this.reinitCommentsOnEveryView&&this.comments[i])return;const n=e.elem.getAttribute("data-comments-id");this.initComments(n,t)}async onClick(e){if(!this.isEnabled)return;let{type:t}=e;const{payload:i}=e;let{id:s}=i||{};const{expandComments:n,uuid:o,loadSpotImJS:a}=i||{};let r;if((a||n)&&(await this.loadSpotImIfNeeded(),this.didMainArticleRender||"smartphone"===this.device||(await new Promise((e=>{window.wafer.on("caas:article:inview",e)})),this.didMainArticleRender=!0),await new Promise((e=>{setTimeout((()=>{e({})}),10)}))),o){const e=document.querySelector(`.view-spotim-cmnts-btn-container[data-uuid="${o}"] .view-spotim-cmnts-btn`);if(!s&&e&&(t="viewSpotIm",e.scrollIntoView?.({behavior:"smooth",block:"center"}),s=`spotim-wrapper-${o}`,e.parentElement.removeChild(e)),"viewSpotIm"===t&&s){const[e]=await window.wafer.caas.getData([o]);if(e){const{title:t,url:i}=e;return window.wafer.state={currentArticleTitle:t,currentArticleUrl:i},void this.initComments(s,e,{scrollIntoView:n})}}r=this.comments[o]?.commentsNode}(n||"comments"===t)&&r?.scrollIntoView?.({behavior:"smooth",block:"center"})}}({device:"desktop"}),new class{constructor(){}async onViewerOpened(){window.wafer.base.closeLightbox()}onViewerDidClose(){window.wafer.base.closeLightbox({scrollRestore:!1})}},new class{init(){this.initPrestigeLayout=this.initPrestigeLayout.bind(this),window.wafer.on("caas:article:init",this.initPrestigeLayout)}isPrestige(e){return"prestige"===(e.meta.data.presentation||"")}initPrestigeLayout(e){this.isPrestige(e)&&$.classList.add(_)}onViewerClosed(){$.classList.remove(_)}},new class{init(e){if(this.pollConfig=e?.factualPoll||{},this.pollConfig?.enabled){const e=this.onArticleFetch.bind(this);window.wafer.on("caas:article:fetch",e)}}onArticleFetch(e){const t=this.pollConfig.config?.doNotUseshareWidth||!1,{factualPollId:i=""}=e.meta.data,s=e.elem.id,n=e.elem.getAttribute("data-polls-id"),o=document.getElementById(n);if(!o||!i)return;if(!t){const t=e.elem.querySelector(".caas-share-section")?.clientWidth||0;t&&Object.assign(o.style,{marginLeft:`${t}px`})}let a="";if("mainArticle"===s)a="viewerMainArticlePollId";else{a=`viewer${s[0].toUpperCase()+s.slice(1)}PollId`}window.wafer.state={[a]:i}}onViewerDidClose(){window.wafer.state={viewerClusterArticle1PollId:"wf-state-reset",viewerClusterArticle2PollId:"wf-state-reset",viewerClusterArticle3PollId:"wf-state-reset",viewerClusterArticle4PollId:"wf-state-reset",viewerClusterArticle5PollId:"wf-state-reset",viewerMainArticlePollId:"wf-state-reset"}}},new class{constructor(){document.getElementById("content-viewer-template")||window.wafer.ready((()=>{this.bootstrap()}))}init(){}async bootstrap(){const e=h(),t=e?.apptype,i=e?.region||"US",s=e?.device,n=e?.contentSite,o=e?.partner,{site:a="fp",...r}=window.rapidInstance?.getRapidAttribute("keys"),c=e?.lang||r.lang||"en-US",d={contentSite:n,device:s,lang:c,partner:o,region:i,site:a},l=`${v()?"":"https://www.yahoo.com"}${n?`/${n}/layouts`:"/layouts"}?${p({apptype:t,device:s,lang:c,partner:o,region:i,site:a})}`;try{const{configs:e,layout:t}=await window.wafer.utils.fetchWithCache(l,{cacheStrategy:"cacheFirst",cacheTtl:1e3,credentials:"include"});document.body.insertAdjacentHTML("beforeend",t),window.adsConfig=window.adsConfig||e.ads,e.viewer?.rightRail?.disableSidekick&&e.ads&&(window.adsConfig=e.ads),window.YAHOO.viewer.init({context:d,...e.viewer})}catch(t){window.YAHOO.viewer.init({context:d});const i=`/${m(e?.site||"fp")}?error=layout_fetch_failed&message=${t?.message}`;window.wafer.utils.fireBeacon(i,{useNavigator:!1,useTimestamp:!1})}window.wafer.base.sync(document.body)}}];H.push(new class{constructor(){this.homeProperty=""}init(){if("function"!=typeof g(window,"s.t"))return;this.adobeAnalytics=window.s;const e=h();var t,i;this.contentSite=e.contentSite,this.adobeAnalytics&&window.wafer.on("caas:article:inview",this.adobeAnalytics.t),this.homeProperty=(t=window.location.hostname,i=this.contentSite,"www"!==t.split(".",1)[0]?t.split(".",1)+"":i||"")}async onContentDidChange(){this.adobeAnalytics&&(this.adobeAnalytics.prop53="Modal")}async onClick({type:e}){const t=this.adobeAnalytics;t&&"article"===e&&setTimeout((()=>{const e=t.pna||"";let i=window.location.hostname.split(".",1);"www"===i[0]&&(i=[this.contentSite||""]),t.pageName=`net|${i}|${e}`}),10)}async onViewerClosed(){const e=this.adobeAnalytics;if(!e)return;const t=e.pna||"";e.pageName=`net|${this.homeProperty}|${t}`,e.prop53="Modal Close",setTimeout((()=>{e.t(),e.clearVars()}),5)}}),window.YAHOO.viewer=new class{constructor(e){this.handlers={};const t=this.dispatch.bind(this);e.forEach((e=>e.dispatch=t)),this.mapPluginHandlers(e)}mapPluginHandlers(e){for(const t in x)if(t in x){this.handlers[t]=[];for(const i of e)if(t in i){const e=i[t].bind(i);this.handlers[t].push(e)}}}init(e){this.dispatch(S,e)}dispatch(e,...t){const i=[];for(const s of this.handlers[e]){const e=s(...t);e instanceof Promise&&i.push(e)}return Promise.all(i)}}(H),(()=>{const e=window.YAHOO.viewerConfig;if(e){const t=window.wafer.ready;function i(){window.YAHOO.viewer.init(e)}t?t(i):document.body.addEventListener("wafer:ready",i)}})()}();
//# sourceMappingURL=desktop_1.11.130.modern.js.map
