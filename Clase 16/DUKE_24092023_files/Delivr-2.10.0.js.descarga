!function(){var e={998:function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}"function"!=typeof Object.create&&(Object.create=function(t,n){function r(){}if(r.prototype=t,"object"===e(n))for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);return new r})},123:function(){Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}!function(){"use strict";n(998),n(123);var e=t(window).nsVersion;function t(e){var t=e.com=e.com||{};return t.oath=t.oath||{},t.oath.craft=t.oath.craft||{},t.oath.craft.delivery=t.oath.craft.delivery||{},t.oath.craft.delivery["v2.10.0"]=t.oath.craft.delivery["v2.10.0"]||{},{ns:t.oath.craft.delivery,nsVersion:t.oath.craft.delivery["v2.10.0"]}}e.createNamespace=t;var r=e;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"trim",value:function(e){return"string"==typeof e?e.replace(/^[\s]+|[\s]+$/g,""):""}}],null&&i(t.prototype,null),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.StringUtils=o;var a=o,s=!1;function c(e){var t=function(){if(!s)return s=!0,e()};if("complete"===document.readyState)return t();if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",t),window.attachEvent("onload",t);var n=!1;try{n=null===window.frameElement}catch(e){console.error(e.message)}if(document.documentElement.doScroll&&n)return function e(){if(!s){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(e,1)}return t()}}()}}function u(e){if(void 0!==window.addEventListener)window.addEventListener("load",e,!1);else if(void 0!==document.addEventListener)document.addEventListener("load",e,!1);else if(void 0!==window.attachEvent)window.attachEvent("onload",e);else if("function"==typeof window.onload){var t=window.onload;window.onload=function(){t(),e()}}else window.onload=e}function l(e,t){Object.keys(t).forEach((function(n){e.style[n]=t[n]}))}function f(e){for(var t=0,n=0;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{x:t,y:n}}function h(e,t){try{return void 0!==e.currentStyle?e.currentStyle[t]:window.getComputedStyle(e,null)[t]}catch(e){return null}}function d(e){return null==e?"":isNaN(e)?e:e+"px"}function p(e){return[].slice.call(e)||[]}function v(e){var t=e;return e&&e.body?t=e.body:e&&e.document&&e.document.body&&(t=e.document.body),t}function y(e,t){var n=t;if(null==t){if(!(window&&window.parent&&window.parent.document&&window.parent.document.body))return null;n=window.parent.document.body}var r=p(n.querySelectorAll("*")).map((function(e){return e.shadowRoot})).filter(Boolean).map((function(t){return y(e,t)}));try{return p(n.querySelectorAll(e)).concat(r).flat()}catch(e){return null}}function m(e,t){var n=v(t);if(null==n)return null;var r=y("#".concat(e),n);return r&&r[0]?r[0]:null}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r.DOMUtils={addDOMLoadListener:c,addPageLoadListener:u,applyStyles:l,calculateAbsolutePosition:f,getComputedStyle:h,getDocumentSize:function(){var e=document;return{width:Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth)),height:Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}},convertStyleLength:d,querySelectorAllShadows:y,shadowByClassName:function(e,t){var n=v(t);return null==n?null:y(".".concat(e),n)||null},shadowById:m};var E=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"getTagOverrides",value:function(t){if("object"===b(t)&&t.anchorDivId){var n=document.getElementById(t.anchorDivId)||m(t.anchorDivId,window);if(n)for(var r=n.previousSibling;r&&"IMG"!==r.nodeName;){if(r.nodeType===Node.COMMENT_NODE&&r.nodeValue.indexOf(e.OVERRIDE_MARKER)>-1){var i=r.nodeValue;return e.parseOverrideComment(i)}r=r.previousSibling}}return{}}},{key:"parseOverrideComment",value:function(t){var n={};return a.trim(t).split("\n").forEach((function(t){if(!(t.indexOf(e.OVERRIDE_MARKER)>-1)){var r=t.split(e.OVERRIDE_KV_DELIM);2===r.length&&(n[a.trim(r[0])]=a.trim(r[1]))}})),n}}],null&&g(t.prototype,null),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();E.OVERRIDE_MARKER="##delivr.ad.overrides##",E.OVERRIDE_KV_DELIM=":",r.TagOverridesUtils=E;var O=E,w=function(){try{console.warn.apply(console,[].slice.call(arguments))}catch(e){try{console.warn(arguments[0])}catch(e){}}};function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=["[timestamp]","{random}","_ADTIME_","_TIMESTAMP_","{%r%}","%%CACHEBUSTER%%","${REQUESTID}","[CACHEBUSTER]","[INSERT_CACHEBUSTER_HERE]","${ADCALL_ID}","_ADSTAGE_"],S=["${PLACEMENTID}","_ADADEXTID_"],I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"requestPixel",value:function(t){if("string"==typeof t&&t.match(/https?:\/\//i)){var n=new Image;n.src=t,e.pixels.push(n)}}},{key:"requestPixels",value:function(t){for(var n=0;n<t.length;n++){var r=t[n];e.requestPixel(r)}}},{key:"loadScript",value:function(e,t){if("string"==typeof e&&e.match(/https?:\/\//i)){var n=document.createElement("script");n.async=!0,n.charset="utf-8",n.src=e;var r=document.getElementById(t);r?r.parentNode.insertBefore(n,r.nextSibling):document.body.insertBefore(n,document.body.firstChild)}}},{key:"loadScripts",value:function(t,n){for(var r=0;r<t.length;r++){var i=t[r];e.loadScript(i,n)}}},{key:"fillMacros",value:function(t,n){return t&&t.length>0&&(t=e.fillCacheBuster(t),t=e.fillLineId(t,n)),t}},{key:"replaceMacro",value:function(e,t,n){return t=t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),e.replace(new RegExp(t,"ig"),n)}},{key:"fillCacheBuster",value:function(t,n){return t&&(n=n||+new Date,T.forEach((function(r){t=e.replaceMacro(t,r,n)}))),t}},{key:"fillLineId",value:function(t,n){if(t&&n&&n.DeliveryServerTag&&n.DeliveryServerTag.variables&&n.DeliveryServerTag.variables.srvlid){var r=n.DeliveryServerTag.variables.srvlid;S.forEach((function(n){t=e.replaceMacro(t,n,r)}))}return t}}],null&&C(t.prototype,null),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();I.pixels=[],r.TrackingUtils=I;var P=I;function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A.apply(this,arguments)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var R=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._rawConfig=t,this.AdManager={},this.AdServer={},this.Platform={},this.Creative={},this.Format={},this.Integrator={},this.Regs={},this.Publisher={},this.DeliveryGroups={},this.Overrides={},this.User={},this.DeliveryServerTag={},A(this,t),this.applyDeliveryGroupConfig(),this.setOverridesFromTag(),this.setImpressionId()}var t,n;return t=e,(n=[{key:"setImpressionId",value:function(){var e=Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2);if(this.DeliveryServerTag&&this.DeliveryServerTag.variables){var t=this.DeliveryServerTag.variables||{};["impid","srvreqid","srvrid"].forEach((function(n){t[n]&&(t[n]=P.fillCacheBuster(t[n],e))}))}this.AdServer.impressionId&&(this.AdServer.impressionId=P.fillCacheBuster(this.AdServer.impressionId,e))}},{key:"getOverride",value:function(e){return this.Overrides.hasOwnProperty(e)?this.Overrides[e]:null}},{key:"getFileUrl",value:function(e){return e&&!e.match(/^https?:\/\//i)?"".concat(this.AdServer.proto,"://").concat(this.Platform.cdn.host).concat(this.Creative.assetPath)+e:e}},{key:"applyDeliveryGroupConfig",value:function(){var e=this,t=this.AdServer.deliveryGroupId;if(this.DeliveryGroups[t]){var n=this.DeliveryGroups[t];n.clicks&&Object.keys(n.clicks).forEach((function(t){e.Creative.clicks.hasOwnProperty(t)&&(e.Creative.clicks[t].url=n.clicks[t].url)}))}}},{key:"setOverridesFromTag",value:function(){var e=O.getTagOverrides(this);A(this.Overrides,e)}},{key:"clone",value:function(){return A({},this._rawConfig,{Overrides:this.Overrides})}},{key:"invokeHook",value:function(e,t){if(this.Format.library&&this.Format.library.hooks&&this.Format.library.hooks[e])try{return this.Format.library.hooks[e].apply(null,t)}catch(t){w("[AdConfig]: error in invokeHook '".concat(e,"':"),t)}}}])&&k(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();R.override={RENDER_BACKUP:"renderBackup",TARGET_WINDOW:"targetWindow"},R.hookTypes={BEFORE_ADVERT_INIT:"beforeAdvertInit",AFTER_ADVERT_INIT:"afterAdvertInit",ON_SAFEFRAME_STATUS_UPDATE:"onSafeFrameStatusUpdate"},r.AdConfig=R;var _=R;function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t,n){return t&&D(e.prototype,t),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var L=j((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.target=null}));r.Event=L;var N=L;function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function F(e,t){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},F(e,t)}function x(e,t){if(t&&("object"===U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=M(n);if(r){var i=M(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return x(this,e)});function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this,e)).advert=t?t.advert:null,n}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);B.ADDED="advertEvent.added",B.INTERACTIVE_IMPRESSION="advertEvent.interactiveImpression",B.INITIALIZED="advertEvent.initialized",r.AdvertEvent=B;var H=B,V="delivr.safeFrameSandbox";function Q(){try{if(window.sfAPI||window.$sf.ext)return!0}catch(e){}return!1}function K(){return!!document.querySelector('meta[name="'.concat(V,'"]'))}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r.SafeFrameUtils={isInFlexFrame:function(){if(Q()||K()){var e=(K()?parent:window).$sf.ext;try{var t=e.ui();if("string"==typeof t.flex||"number"==typeof t.flex&&0!==t.flex)return!0}catch(e){console.error(e.message)}}return!1},isInSafeFrame:Q,isInSafeFrameSandbox:K,getSafeFrameSandbox:function(){return window.oneCreativeSafeFrameSandbox},SANDBOX_META_NAME:V};var W=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.type.WEB;G(this,e),this.backupImage=!1,this.friendlyIframe=!1,this.iframe=!1,this.safeFrame=!1,this.safeFrameSandbox=!1,this.skypeFrame=!1,this.environmentType=t}var t,n;return t=e,(n=[{key:"determineEnvironment",value:function(){this.backupImage=this.requiresBackupImage(),this.iframe=r.IframeUtils.isInIframe(),this.safeFrame=r.SafeFrameUtils.isInSafeFrame(),this.safeFrameSandbox=r.SafeFrameUtils.isInSafeFrameSandbox(),this.skypeFrame=this.isInSkypeFrame()}},{key:"determineEnvironmentForAdConfig",value:function(e){this.friendlyIframe=r.IframeUtils.isInFriendlyIframe(e)}},{key:"type",get:function(){return this.environmentType}},{key:"requiresBackupImage",value:function(){return!r.UserAgentUtils.isW3CCompliant()||!r.UserAgentUtils.supportsJSON()||!r.UserAgentUtils.supportsPostMessageWithObjects()}},{key:"isInSkypeFrame",value:function(){return!(!window.$WLXRmAd||"function"!=typeof window.$WLXRmAd.init)}}])&&q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();W.type={WEB:"WEB",MRAID:"MRAID",VPAID:"VPAID"},r.Environment=W;var X=W;function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function z(e,t){if(Array.isArray(t)){if(t.indexOf(e)>=0)return!0}else for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e)return!0;return!1}function Z(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=0;r<t.length;r++){var i=t[r];e.hasOwnProperty(i)&&(n[i]=e[i])}return n}function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r.CollectionUtils={contains:z,pick:Z,recursiveReplace:function(e,t){for(var n in e)if(e.hasOwnProperty(n))if("object"!==Y(e[n])||Array.isArray(e[n])){if("string"==typeof e[n])for(var r in t)if(t.hasOwnProperty(r)){var i=new RegExp(r,"g");e[n]=e[n].replace(i,t[r])}}else this.recursiveSubtitute(e[n],t)},shallowObjectEquals:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||e[n]!==t[n]))return!1;return!0}};var ee=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=t,this.eventTypes={}}var t,n;return t=e,(n=[{key:"on",value:function(e,t,n){void 0===this.eventTypes[e]&&(this.eventTypes[e]=[]),z(t,this.eventTypes[e])||(void 0===n?this.eventTypes[e].push(t):this.eventTypes[e].push({ref:n,handler:t}))}},{key:"off",value:function(e,t,n){var r=this;Array.isArray(this.eventTypes[e])&&this.eventTypes[e].forEach((function(i,o){var a=void 0===n?"function":"object";if(a===$(i))switch(a){case"function":i===t&&r.eventTypes[e].splice(o,1);break;case"object":i.handler===t&&i.ref===n&&r.eventTypes[e].splice(o,1)}}))}},{key:"hasEventListener",value:function(e,t,n){if(void 0===this.eventTypes[e]||0===this.eventTypes[e].length)return!1;for(var r=0;r<this.eventTypes[e].length;r++){var i=this.eventTypes[e][r],o=void 0===n?"function":"object";if(o===$(i))switch(o){case"function":if(i===t)return!0;break;case"object":if(i.handler===t&&i.ref===n)return!0}}return!1}},{key:"trigger",value:function(e){if("string"==typeof e&&(e=new N(e)),"string"==typeof e.type&&void 0!==this.eventTypes[e.type]){void 0!==e.target&&null!==e.target||(e.target=this.target),e.currentTarget=this.target;for(var t=this.eventTypes[e.type].slice(0),n=0;n<t.length;n++){var r=t[n];if("object"===$(r))try{r.handler.call(r.ref,e)}catch(e){}else r(e)}}}}])&&J(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.EventDispatcher=ee;var te=ee;function ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,r=null,i=null,o=function(){e.apply(n,i),r=null};return function(){if(!r){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];i=n,r=setTimeout(o,t)}}}function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ie(e,t){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ie(e,t)}function oe(e,t){if(t&&("object"===re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ae(e){return ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ae(e)}r.EventUtils={addCustomEventHandler:function(e,t,n){if(Array.isArray(n)&&e instanceof te)for(var r=0;r<n.length;r++){var i=n[r];i.custom&&e.on(i.name,t.customEventHandler,t)}},throttle:ne};var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ie(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae(n);if(r){var i=ae(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return oe(this,e)});function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),n=i.call(this,e),t&&(n.offsetX=t.offsetX,n.offsetY=t.offsetY,n.width=t.width,n.height=t.height,n.visible=t.visible),n}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);se.FOCUS="hostPageEvent.focus",se.BLUR="hostPageEvent.blur",se.VISIBILITY_CHANGE="hostPageEvent.visibilityChange",se.LOAD="hostPageEvent.pageLoad",se.SCROLL="hostPageEvent.pageScroll",se.RESIZE="hostPageEvent.pageResize",se.ORIENTATION_CHANGE="hostPageEvent.orientationChange",r.HostPageEvent=se;var ce=se;function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}function he(e,t){if(t&&("object"===ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function de(e){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},de(e)}var pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=de(n);if(r){var i=de(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return he(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return le(this,o),(t=i.call(this,e)).container=n.container||null,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);pe.ATTACH="domEvent.attach",pe.DETACH="domEvent.detach",pe.LOAD="domEvent.load",pe.BEFORE_UNLOAD="domEvent.beforeUnload",r.DOMEvent=pe;var ve=pe;function ye(e){e.setAttribute("allowfullscreen","true"),e.setAttribute("allowFullScreen","true"),e.setAttribute("mozallowFullScreen","true"),e.setAttribute("webkitAllowFullScreen","true")}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(e===parent&&r.contentWindow===window||e===parent.parent&&r.contentWindow===window.parent)return r}return null}function be(e){var t=[].slice.call(e.document.getElementsByTagName("iframe")),n=me(e,t);return null===n&&(n=me(e,t=y("iframe"))),n}function ge(e){var t=parent,n=document.querySelector('meta[name="delivr.ad.targetWindow"]'),r=n?n.getAttribute("content"):null;switch(e.getOverride(_.override.TARGET_WINDOW)||r){case"self":t=window;break;case"parent.parent":t=window.parent.parent;break;case"TOP":t=window.top}return t}function Ee(){return window!==top}function Oe(){var e=!1;try{top.document&&(e=!0)}catch(e){}return e?top:window}function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function Ce(){return navigator.appName.toLowerCase()}function Te(){return navigator.userAgent.toLowerCase()}function Se(){var e=Te();return"netscape"===Ce()&&null!==new RegExp("trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(e)?1:e.indexOf("msie")>-1}function Ie(){return!!Te().match(/(ipad|iphone|ipod)/i)}function Pe(){return!!Te().match(/android/i)}function Ae(){return!!Te().match(/windows phone/i)}function ke(){return Te().indexOf("applewebkit")>-1}function Re(e){var t=e?Oe().document:document;return{x:t.pageXOffset||t.documentElement.scrollLeft||t.body.scrollLeft,y:t.pageYOffset||t.documentElement.scrollTop||t.body.scrollTop}}function _e(e){var t=e?Oe().document:document,n="CSS1Compat"===t.compatMode,r=t.documentElement.clientWidth,i=n&&r||t.body.clientWidth||r,o=t.documentElement.clientHeight,a=n&&o||t.body.clientHeight||o;return Ie()&&a<window.innerHeight&&(a=window.innerHeight),{w:i,h:a}}function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r.IframeUtils={applyAllowFullScreenAttribute:ye,getTargetIframeEl:be,determineTargetWindow:ge,isInFriendlyIframe:function(e){var t=!1;try{this.determineTargetWindow(e).document&&(t=!0)}catch(e){}return t},isInIframe:Ee,topOrSelf:Oe},r.UserAgentUtils={getAppName:Ce,getUserAgent:Te,isChrome:function(){return"object"===we(window.chrome)},isIE:Se,isIEQuirksMode:function(){return Se()&&document.compatMode&&"BackCompat"===document.compatMode},isiOS:Ie,isWebkit:ke,isAndroid:Pe,isWinPhone:Ae,isW3CCompliant:function(){var e="undefined",t=document;return we(t.getElementById)!==e&&we(t.getElementsByTagName)!==e&&we(t.createElement)!==e},supportsJSON:function(){return window.JSON&&JSON.parse&&JSON.stringify},supportsPostMessageWithObjects:function(){if(!window.postMessage)return!1;var e=!1;try{window.postMessage({toString:function(){e=!0}},"*")}catch(e){}return!e}},r.ViewportUtils={getPageOffsets:Re,getViewportDims:_e};var je=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.env=t.env,this.globalEventBus=t.globalEventBus,this.domLoaded=!1,this.pageLoaded=!1,this.windowInFocus=!0,this.visible=!0}var t,n;return t=e,(n=[{key:"addLoadListeners",value:function(){var e=this;c((function(){e.dispatchDOMLoadEventOnce(),e.checkPageLoadStatus()})),u((function(){return e.dispatchPageLoadEventOnce()}))}},{key:"addWindowEventListeners",value:function(){var e=this;if(!this.windowEventListenersAdded){this.windowEventListenersAdded=!0;var t=window;this.env.friendlyIframe&&this.env.type!==X.type.VPAID&&(t=Oe()),t.addEventListener("scroll",ne((function(){return e.dispatchViewportEvent(ce.SCROLL)}),250),!1),t.addEventListener("resize",ne((function(){return e.dispatchViewportEvent(ce.RESIZE)}),250),!1),t.addEventListener("orientationchange",(function(){return e.dispatchViewportEvent(ce.ORIENTATION_CHANGE)}),!1),t.addEventListener("focus",(function(){return e.handleFocusChange(!0)})),t.addEventListener("blur",(function(){return e.handleFocusChange(!1)})),t.addEventListener("beforeunload",(function(){return e.handleOnBeforeUnload()})),document.addEventListener("visibilitychange",(function(t){return e.handlePageVisibilityChange(t)})),t.hasFocus&&t.hasFocus()?this.handleFocusChange(!0):this.handleFocusChange(!1)}}},{key:"checkPageLoadStatus",value:function(){var t=this;this.pageLoaded||(this.pageLoadStatusTimeout=setTimeout((function(){t.dispatchPageLoadEventOnce(),clearTimeout(t.pageLoadStatusTimeout)}),e.LOAD_TIMEOUT))}},{key:"dispatchDOMLoadEventOnce",value:function(){this.domLoaded||(this.domLoaded=!0,this.globalEventBus.trigger(ve.LOAD))}},{key:"dispatchPageLoadEventOnce",value:function(){this.pageLoaded||(this.pageLoaded=!0,this.dispatchViewportEvent(ce.LOAD))}},{key:"dispatchViewportEvent",value:function(e){var t=Re(this.env.friendlyIframe),n=_e(this.env.friendlyIframe),r=new ce(e,{offsetX:t.x,offsetY:t.y,width:n.w,height:n.h});this.globalEventBus.trigger(r)}},{key:"handleFocusChange",value:function(e){e&&!this.windowInFocus?(this.windowInFocus=!0,this.globalEventBus.trigger(ce.FOCUS)):!e&&this.windowInFocus&&(this.windowInFocus=!1,this.globalEventBus.trigger(ce.BLUR))}},{key:"handlePageVisibilityChange",value:function(){this.visible=!document.hidden;var e=new ce(ce.VISIBILITY_CHANGE,{visible:this.visible});this.globalEventBus.trigger(e)}},{key:"handleOnBeforeUnload",value:function(){this.globalEventBus.trigger(ve.BEFORE_UNLOAD)}}])&&De(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();je.LOAD_TIMEOUT=4e3,r.PublisherPage=je;var Le=je;function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ue=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adverts={},this.globalEventBus=new te(this),this.env=new X(t.environmentType),this.env.determineEnvironment(),this.hostPage=new Le(this),this.hostPage.addLoadListeners(),this.advertClass=t.advertClass,this.breakoutFactory=t.breakoutFactory,this.containerFactory=t.containerFactory,this.trackerClass=t.trackerClass}var t,n;return t=e,n=[{key:"registerAds",value:function(e){for(var t=e.length-1;t>-1;t--){var n=e.splice(t,1)[0];this.registerAd(n)}}},{key:"registerAd",value:function(e){var t=new _(e);if(this.env.determineEnvironmentForAdConfig(t),this.breakoutFactory){var n=this.breakoutFactory.getBreakoutStrategy(t,this.env);if(n){if(n.breakout())return;t.Overrides[_.override.RENDER_BACKUP]=!0}}return this.initAd(t)}},{key:"initAd",value:function(e){var t=String(e.AdServer.cacheBuster);e.Publisher.url=Ee()?document.referrer:location.href,this.hostPage.addWindowEventListeners();var n=this.adverts[t]=new this.advertClass,i={window:window,advert:n,libraryNamespace:r};return e.invokeHook(_.hookTypes.BEFORE_ADVERT_INIT,[i]),n.init(e,this),this.globalEventBus.trigger(new H(H.ADDED,{advert:n})),e.invokeHook(_.hookTypes.AFTER_ADVERT_INIT,[i]),n}},{key:"cleanup",value:function(){this.adverts={}}}],n&&Ne(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.BaseAdManager=Ue;var Fe=Ue,xe="inlineDiv";function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r.ContainerType={INLINE_DIV:xe,FLOATING_DIV:"floatingDiv",NO_CONTENT:"noContent"};var Be=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adConfig=t}var t,n,i;return t=e,i=[{key:"bootstrapFriendlyWindow",value:function(t,n){var i;try{i=r.createNamespace(t).nsVersion}catch(e){return!1}e.bootstrapPrependedTrackEvents(t,n);var o=i[n.AdManager.NAME];if(o)o.registerAd(n);else{(i[n.AdManager.CONFIG_QUEUE]=i[n.AdManager.CONFIG_QUEUE]||[]).push(n);var a=r[n.AdManager.LOADED_VERSIONS],s=n.Format.library.version;if(!a||-1===a.indexOf(s)){(a=r[n.AdManager.LOADED_VERSIONS]=r[n.AdManager.LOADED_VERSIONS]||[]).push[s];var c=document.createElement("script");c.src=n.Format.library.url,t.document.body.insertBefore(c,t.document.body.firstChild)}}return!0}},{key:"bootstrapPrependedTrackEvents",value:function(e,t){try{var n=t.Creative.id;e.com=e.com||{},e.com.yahoo=e.com.yahoo||{},e.com.yahoo.craft=e.com.yahoo.craft||{},e.com.yahoo.craft.prependedTrackerEvents=e.com.yahoo.craft.prependedTrackerEvents||{},e.com.yahoo.craft.prependedTrackerEvents[n]=window.com.yahoo.craft.prependedTrackerEvents[n]}catch(e){}}}],(n=[{key:"breakout",value:function(){var t=be(ge(this.adConfig));if(!t)return!1;var n=t.ownerDocument.defaultView,r=this.adConfig.clone();return r.anchorPlaceholder=t,e.bootstrapFriendlyWindow(n,r)}}])&&Me(t.prototype,n),i&&Me(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.FriendlyIframeBreakout=Be;var He=Be;function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"breakout",value:function(){}}])&&Ve(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.NonFriendlyIframeBreakout=Qe;var Ke=Qe;function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function We(e,t){return We=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},We(e,t)}function Xe(e,t){if(t&&("object"===Ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ye(e){return Ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ye(e)}var ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&We(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ye(n);if(r){var i=Ye(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Xe(this,e)});function o(){return qe(this,o),i.apply(this,arguments)}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);ze.RENDER="renderEvent.render",r.RenderEvent=ze;var Ze=ze;function $e(){return $e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$e.apply(this,arguments)}function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var et=function(){function e(t,n,r,i,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentFactory=t,this.eventBus=new te(this),this.adManager=o,this.globalEventBus=o.globalEventBus,this.hostPage=o.hostPage,this.adEventBus=i.eventBus,this.advert=i,this.windowContext=window,this.id=r,this.rendered=!1,this.expanded=!1,this.closed=!1,this.advertAnchorId=n.anchorDivId,this.advertAnchorDiv=n.anchorDiv,this.advertAnchorPlaceholder=n.anchorPlaceholder,this.content=null,this.autoRender=!0,this.expandAdapter=a,this.state,this.states={},this.zIndex=10,this.init(n)}var t,n;return t=e,(n=[{key:"init",value:function(t){var n=t.Creative.containers[this.id];this.adConfig=t,this.copyProperties(n),this.state=this.initialState||e.state.DEFAULT,this.parentElementId&&(this.containerAnchorParent=document.getElementById(this.parentElementId),this.containerAnchorParent||(this.containerAnchorParent=document.createElement("div"),this.containerAnchorParent.id=this.parentElementId,document.body.appendChild(this.containerAnchorParent)),this.containerAnchorId=this.advertAnchorId+"_"+this.id),this.uid=this.id.replace(/[ /.-]/g,"_")+"_"+t.AdServer.cacheBuster,this.contentId=e.CONTENT_ID_PREFIX+this.uid,this.addRenderEventListeners(),this.content=this.contentFactory.getContent(this,t,this.id,this.advert,this.adManager,this.contentId),this.expandAdapter&&this.expandAdapter.init(this,this.getState(this.state))}},{key:"copyProperties",value:function(t){var n=this;$e(this,t),Object.keys(this.states).forEach((function(t){var r=Object.create(e.STATE_DEFAULTS);n.states[t]=$e(r,n.states[t])}))}},{key:"getState",value:function(e){return this.states.hasOwnProperty(e)?{key:e,data:this.states[e]}:null}},{key:"addRenderEventListeners",value:function(){var e=this;this.globalEventBus.on(ve.LOAD,(function(t){return e.coreLibEventHandler(t)})),this.globalEventBus.on(ce.LOAD,(function(t){return e.coreLibEventHandler(t)})),this.adEventBus.on(H.INITIALIZED,(function(t){return e.coreLibEventHandler(t)}))}},{key:"coreLibEventHandler",value:function(){this.checkAutoRender()}},{key:"checkAutoRender",value:function(){!this.rendered&&this.autoRender&&this.render()}},{key:"render",value:function(){this.rendered||this.closed||(this.rendered=!0,this.eventBus.trigger(Ze.RENDER))}},{key:"expand",value:function(e){}},{key:"contract",value:function(e){}},{key:"show",value:function(){}},{key:"hide",value:function(){}},{key:"reload",value:function(){}},{key:"close",value:function(){this.rendered&&(this.closed=!0,this.rendered=!1)}},{key:"getContent",value:function(){return this.content}}])&&Je(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();et.CONTENT_ID_PREFIX="craftContent_",et.DWELL_MIN_VIEWABLE_PERCENTAGE=.5,et.ACCEPTABLE_VIEW_AREA=37500,et.UNIT_PX="px",et.state={DEFAULT:"default",EXPAND:"expand",FULLSCREEN:"fullscreen"},et.STATE_DEFAULTS={offsetX:0,offsetY:0},et.STATE_PRECEDENCE=[et.state.FULLSCREEN,et.state.EXPAND,et.state.DEFAULT],r.AssetContainer=et;var tt=et;function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adConfig=t}var t,n;return t=e,(n=[{key:"breakout",value:function(){return this.registerCreative(),this.createSafeFrameSandbox()}},{key:"registerCreative",value:function(){var t=this.adConfig.Creative.containers.placement.states.default;r[e.registration.PROXY_FN_NAME]=function(t){t("register",r[e.registration.DATA_KEY]),r[e.registration.CALLBACK_FN_REF]=t};try{r[e.registration.STATUS_HOOK_REF]=this.adConfig.Format.library.hooks[_.hookTypes.ON_SAFEFRAME_STATUS_UPDATE]}catch(e){console.error(e)}window.$sf.ext.register(t.width,t.height,(function(t,n){if("register"!==t&&"register-update"!==t||(r[e.registration.DATA_KEY]=n),"function"==typeof r[e.registration.STATUS_HOOK_REF])try{var i=e.registration.STATUS_HOOK_REF;if(!1===r[i].apply(null,[t,n]))return}catch(e){console.error(e)}if("function"==typeof r[e.registration.CALLBACK_FN_REF])try{r[e.registration.CALLBACK_FN_REF](t,n)}catch(e){console.error(e)}}))}},{key:"createSafeFrameSandbox",value:function(){var e=this.adConfig.Creative.containers.placement.states[tt.state.DEFAULT],t=document.createElement("iframe");t.id="craftSafeFrameSandbox_".concat(this.adConfig.AdServer.cacheBuster),t.seamless="seamless",t.allowtransparency="true",t.scrolling="no",ye(t),l(t,{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),border:0,overflow:"hidden"});var n=e.offsetX<0?"right:0px;":"left:0px;",r=e.offsetY<0?"bottom:0px;":"top:0px;",i='<!DOCTYPE html><html><head><meta name="'.concat(V,'"></head>')+'<body style="padding:0;margin:0;width:100%;">'+'<div style="position:absolute;'.concat(n).concat(r,'">')+'<div id="'.concat(this.adConfig.anchorDivId,'"></div>')+"</div></body></html>";try{var o=document.getElementById(this.adConfig.DeliveryServerTag.variables.tagId);o.parentNode.insertBefore(t,o)}catch(e){document.body.appendChild(t)}var a=t.contentDocument;return a.open(),a.write(i),a.close(),He.bootstrapFriendlyWindow(t.contentWindow,this.adConfig.clone())}}])&&nt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.SafeFrameBreakout=rt,rt.registration={DATA_KEY:"_sfregdata",PROXY_FN_NAME:"_sfproxyfn",CALLBACK_FN_REF:"_sfcbfn",STATUS_HOOK_REF:"_sfhookgn"};var it=rt;function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var at=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"getBreakoutStrategy",value:function(t,n){var r=null;return t.getOverride(_.override.RENDER_BACKUP)||n.safeFrameSandbox||void 0!==t.anchorPlaceholder||(n.safeFrame?r=new it(t):n.iframe&&e.requiresIframeBreakout(t)&&(r=n.friendlyIframe?new He(t):new Ke(t))),r}},{key:"requiresIframeBreakout",value:function(e){if(ge(e)===window.self)return!1;var t=e.Creative.containers;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if(r.type!==xe||Object.keys(r.states).length>1)return!0}return!1}}],null&&ot(t.prototype,null),n&&ot(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.BreakoutFactory=at;var st=at;function ct(e){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ct(e)}function ut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lt(e,t){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lt(e,t)}function ft(e,t){if(t&&("object"===ct(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}var dt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lt(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ht(n);if(r){var i=ht(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return ft(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ut(this,o),(t=i.call(this,e)).trigger=n.trigger||o.trigger.EVENT,t.name=n.name,t.meta=n.meta||{},t.reportingLabel=n.reportingLabel,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);r.CreativeEvent=dt,dt.TRACKING_REQUEST="creativeEvent.trackingRequest",dt.GLOBAL_RELAY="creativeEvent.globalRelay",dt.QUALIFIED_CLICK="creativeEvent.qualifiedClick",dt.trigger={CLICK:"click",EVENT:"event",TIMER_START:"start",TIMER_STOP:"stop"};var pt=dt;function vt(e){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vt(e)}function yt(e,t){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yt(e,t)}function mt(e,t){if(t&&("object"===vt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bt(e){return bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bt(e)}var gt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yt(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=bt(n);if(r){var i=bt(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return mt(this,e)});function o(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,e)).meta=t,r.source=n,r}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ot="IFRAME",wt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventDispatcher=new te,this.setTarget(t),window.addEventListener("message",this.handlePostMessage.bind(this))}var t,n;return t=e,n=[{key:"setTarget",value:function(e){this.targetFrameOrWindow=e}},{key:"setListenerWindow",value:function(e){e!==window&&e.addEventListener("message",this.handlePostMessage.bind(this))}},{key:"handlePostMessage",value:function(e){e.data&&e.data.topic&&this.eventDispatcher.trigger(new gt(e.data.topic,e.data.meta,e.source))}},{key:"send",value:function(e,t){this.postMessage({topic:e,meta:t},"*")}},{key:"on",value:function(e,t,n){return this.eventDispatcher.on(e,t,n)}},{key:"off",value:function(e,t,n){return this.eventDispatcher.off(e,t,n)}},{key:"postMessage",value:function(){if(this.targetFrameOrWindow)try{var e=this.targetFrameOrWindow;try{e.nodeName&&e.nodeName===Ot&&(e=this.targetFrameOrWindow.contentWindow)}catch(e){}e.postMessage.apply(e,arguments)}catch(e){}}},{key:"cleanup",value:function(){window.removeEventListener("message",this.handlePostMessage)}}],n&&Et(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ct=wt;function Tt(e){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(e)}function St(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function It(e,t){return It=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},It(e,t)}function Pt(e,t){if(t&&("object"===Tt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function At(e){return At=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},At(e)}var kt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&It(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=At(n);if(r){var i=At(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Pt(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return St(this,o),(t=i.call(this,e)).timer=n.timer,t.platformEventType=n.platformEventType,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);r.TimerEvent=kt,kt.TIMER_CHANGE="timerEvent.timerChange";var Rt=kt;function _t(e){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(e)}function Dt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jt(e,t){return jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jt(e,t)}function Lt(e,t){if(t&&("object"===_t(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Nt(e){return Nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nt(e)}var Ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jt(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Nt(n);if(r){var i=Nt(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Lt(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Dt(this,o),(t=i.call(this,e)).name=n.name,t.platformEventType=n.platformEventType,t.duration=n.duration,t.urls=n.urls||{},t.urls.pixels=n.urls.pixels||[],t.urls.redirects=n.urls.redirects||[],t.urls.scripts=n.urls.scripts||[],t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);r.TrackerEvent=Ut,Ut.TRACK="trackerEvent.track";var Ft=Ut;function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bt(e,t){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bt(e,t)}function Ht(e,t){if(t&&("object"===xt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Vt(e){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vt(e)}var Qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bt(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vt(n);if(r){var i=Vt(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Ht(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{events:[]};return Mt(this,o),(t=i.call(this,e)).events=n.events,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);r.QualifiedStateEvent=Qt,Qt.QUALIFIED="qualifiedStateEvent.qualified";var Kt=Qt;function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qt="craft.delivr.advert",Wt=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queue=[],this.connectedToInspectrProxy=!1,this.adEventBus=t.eventBus,this.globalEventBus=t.globalEventBus,this.messenger=new Ct(window.top),this.messenger.on("craft.inspectrProxy.pong",(function(){return n.handlePong()})),this.advertHash=this.generateAdvertHash(t.adConfig),this.publishAdvertAdded(t.adConfig),this.globalEventBus.on(ve.BEFORE_UNLOAD,(function(){return n.publishAdvertRemoved()})),this.adEventBus.on(Kt.QUALIFIED,(function(){return n.publishQualifiedState()})),this.adEventBus.on(Ft.TRACK,(function(e){return n.publishTrack(e)})),this.adEventBus.on(Rt.TIMER_CHANGE,(function(e){return n.publishTimerChange(e)})),this.startPinging()}var t,n;return t=e,n=[{key:"cleanup",value:function(){this.stopPinging(),this.messenger.cleanup()}},{key:"generateAdvertHash",value:function(e){return[e.Integrator.creativeId||e.AdServer.creativeId||"0",e.AdServer.deliveryGroupId||"0",e.AdServer.cacheBuster||"0"].join("_")}},{key:"publish",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.advertHash=this.advertHash,this.connectedToInspectrProxy?this.messenger.send(e,t):this.queue.push({topic:e,meta:t})}},{key:"startPinging",value:function(){var e=this;this.pingInspectrProxy(),this.pingInterval=setInterval((function(){return e.pingInspectrProxy()}),1e3),this.pingTimeout=setTimeout((function(){return e.stopPinging()}),12e4)}},{key:"stopPinging",value:function(){clearInterval(this.pingInterval),clearTimeout(this.pingTimeout)}},{key:"pingInspectrProxy",value:function(){this.messenger.send("craft.delivr.pingInspectrProxy")}},{key:"handlePong",value:function(){this.connectedToInspectrProxy||(this.stopPinging(),this.connectedToInspectrProxy=!0,this.publishQueue())}},{key:"publishAdvertAdded",value:function(e){var t=e.clone(),n={action:"added",adConfig:JSON.parse(JSON.stringify(t))};this.publish(qt,n)}},{key:"publishAdvertRemoved",value:function(){this.publish(qt,{action:"removed"})}},{key:"publishTimerChange",value:function(e){var t=e.timer,n=e.platformEventType,r={name:t.name,running:t.running,type:n,startTime:t.startTime,cumulativeTimeElapsed:t.cumulativeTimeElapsed};this.publish("craft.delivr.timer",r)}},{key:"publishTrack",value:function(e){var t={name:e.name,type:e.platformEventType,duration:e.duration,urls:e.urls};this.publish("craft.delivr.track",t)}},{key:"publishQualifiedState",value:function(){this.publish("craft.delivr.qualified")}},{key:"publishQueue",value:function(){var e={queue:this.queue.splice(0,this.queue.length)};this.publish("craft.delivr.queue",e)}}],n&&Gt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.Inspectr=Wt;var Xt=Wt;function Yt(e){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yt(e)}function zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zt={ADTECH:["ADTECH","1AS"]},$t=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adConfig=t}var t,n;return t=e,(n=[{key:"getUrls",value:function(e){var t=this,n=[];return"object"!==Yt(e.event)?n:(e.event.trigger===pt.trigger.CLICK&&e.type===On.type.REDIRECT?n=[this.adConfig.AdServer.clickRedirect]:e.event.trigger===pt.trigger.CLICK&&e.type===On.type.PIXEL?n=[this.adConfig.AdServer.clickPixel]:e.event.name===On.event.DOWNLOADED_IMPRESSION&&e.type===On.type.PIXEL&&(n=[this.adConfig.AdServer.downloadedImpressionPixel]),n.filter((function(e){return e.match(/^https?:\/\//i)})).map((function(e){return P.fillMacros(e,t.adConfig)})))}},{key:"servedBy",value:function(e){var t=Zt[e.toUpperCase()];return!!t&&t.indexOf(this.adConfig.AdServer.name.toUpperCase())>-1}}])&&zt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.AdServerTracker=$t;var Jt=$t;function en(){return en=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},en.apply(this,arguments)}function tn(e){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tn(e)}function nn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rn(e){return e.meta&&e.meta.video}var on=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adConfig=t}var t,n;return t=e,(n=[{key:"getUrls",value:function(e){var t=[];if("object"!==tn(e.event)||e.type===On.type.SCRIPT||e.type===On.type.PIXEL&&e.event.trigger===pt.trigger.CLICK)return t;var n=this.buildTrackingURL(e);return(t=[P.fillMacros(n,this.adConfig)]).filter((function(e){return e.match(/^https?:\/\//i)}))}},{key:"buildTrackingURL",value:function(t){var n=this.adConfig.AdServer.proto,r=this.adConfig.Platform.pixelServer.host.GLOBAL;if(!r)throw new Error(e.NO_PIXELSERVER_HOST_ERROR);var i="".concat(n,"://").concat(r).concat(this.adConfig.Platform.pixelServer.path.simple),o=this.buildAdServerParams(),a=this.buildDeliveryServerTagParams(),s={};this.adConfig.Creative.variation&&this.adConfig.Creative.variation.name&&(s["x.vn"]=this.adConfig.Creative.variation.name);var c=en(this.buildGenericParams(t),this.buildExternalParams(),o,a,s,this.buildExtensionParams());c=JSON.parse(JSON.stringify(en(c,o)));var u,l=t.event.trigger===pt.trigger.CLICK?e.ENDPOINT.REDIRECT:e.ENDPOINT.EVENT;return u=t.event.trigger===pt.trigger.CLICK?"&r=":"&".concat(+new Date),"".concat(i,"/").concat(l,"?").concat(this.buildQueryParams(c)).concat(u)}},{key:"getPixelEventType",value:function(t){var n=t.event,r=n.meta&&n.meta.eventName?n.meta.eventName:n.name;if(e.COMMON_EVENT_TYPES.hasOwnProperty(r))return e.COMMON_EVENT_TYPES[r];switch(n.trigger){case pt.trigger.CLICK:return e.COMMON_EVENT_TYPES.click;case pt.trigger.TIMER_STOP:case pt.trigger.TIMER_START:return rn(n)?e.COMMON_EVENT_TYPES.videoDuration:e.COMMON_EVENT_TYPES.contentDuration;default:return rn(n)?n.meta&&"number"==typeof n.meta.durationPercentage?e.COMMON_EVENT_TYPES.videoDuration:n.meta&&n.meta.interaction?e.COMMON_EVENT_TYPES.videoInteraction:e.COMMON_EVENT_TYPES.video:n.meta&&n.meta.interaction?e.COMMON_EVENT_TYPES.userInteraction:e.COMMON_EVENT_TYPES.other}}},{key:"buildQueryParams",value:function(e){return Object.keys(e).map((function(t){var n=e[t];return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))})).join("&")}},{key:"buildGenericParams",value:function(e){var t=e.event,n=t.meta||{};return{et:this.getPixelEventType(e),en:n.eventName?n.eventName:t.reportingLabel?t.reportingLabel:t.name,d:n.duration,dp:n.durationPercentage,crid:this.adConfig.Creative.id,cpid:this.adConfig.Integrator.partnerId,gdpr:this.getGDPRFlag(),euconsent:this.adConfig.Regs.gdpr.consent,us_privacy:this.adConfig.Regs.ccpa?this.adConfig.Regs.ccpa.privacy:"",gpp:this.adConfig.Regs.gpp?this.adConfig.Regs.gpp.string:"",gpp_sid:this.adConfig.Regs.gpp?this.adConfig.Regs.gpp.sectionId:""}}},{key:"buildAdServerParams",value:function(){return{"a.plid":this.adConfig.AdServer.placementId,"a.fid":this.adConfig.AdServer.deliveryGroupId,"a.cid":this.adConfig.AdServer.campaignId,"a.nid":this.adConfig.AdServer.networkId,"a.bid":this.adConfig.AdServer.creativeId,"a.pid":this.adConfig.Publisher.publisherId,"a.sid":this.adConfig.AdServer.sectionId,"a.aid":this.adConfig.AdServer.advertiserId}}},{key:"buildExternalParams",value:function(){return{"e.crid":this.adConfig.Integrator.creativeId||this.adConfig.AdServer.creativeId,"e.plid":this.adConfig.AdServer.placementId,"e.dgid":this.adConfig.AdServer.deliveryGroupId}}},{key:"buildDeliveryServerTagParams",value:function(){var e=this.adConfig.DeliveryServerTag||{},t=e.variables;try{t=JSON.parse(e.variables)}catch(e){}return{"x.srvsrc":(t=t||{}).srvsrc||e.source,"x.srvlid":t.srvlid||e.lineId,"x.srvcid":t.srvcid||e.creativeId,impid:t.impid||t.srvrid||t.srvreqid||this.adConfig.AdServer.impressionId}}},{key:"buildExtensionParams",value:function(){return{"x.w":screen?screen.width:void 0,"x.h":screen?screen.height:void 0}}},{key:"getGDPRFlag",value:function(){var e=this,t="";return[["0","false"],["1","true"]].forEach((function(n,r){n.forEach((function(n){n===e.adConfig.Regs.gdpr.applies&&(t="".concat(r))}))})),t}},{key:"trackDownloadedImpression",value:function(){this.trackEvent({name:"downloadedImpression"})}},{key:"trackEvent",value:function(e){P.loadPixel(this.buildTrackingURL(e))}},{key:"trackClick",value:function(e){}}])&&nn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();on.ENDPOINT={REDIRECT:"ser",EVENT:"se"},on.COMMON_EVENT_TYPES={backupImpression:"bi",backupViewableImpression:"bvi",click:"clk",contentDuration:"cd",downloadedImpression:"di",other:"o",otherUserAction:"oua",impressionDuration:"imd",indeterminableViewability:"iv",interactionDuration:"id",interactiveImpression:"ii",userInteraction:"ui",viewableImpression:"vi",video:"v",videoInteraction:"vin",videoDuration:"vd"},on.NO_PIXELSERVER_HOST_ERROR="Platform.pixelServer.host.GLOBAL property missing in adConfig.",r.PlatformTracker=on;var an=on;function sn(e){return sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sn(e)}function cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var un=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adConfig=t}var t,n;return t=e,(n=[{key:"getUrls",value:function(e){var t=this,n=[];if("object"!==sn(e.event))return n;if(e.event.trigger===pt.trigger.CLICK)switch(e.type){case On.type.REDIRECT:n=[this.adConfig.Publisher.clickRedirect];break;case On.type.PIXEL:n=[this.adConfig.Publisher.clickPixel]}return n.filter((function(e){return e.match(/^https?:\/\//i)})).map((function(e){return P.fillMacros(e,t.adConfig)}))}}])&&cn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.PublisherTracker=un;var ln=un;function fn(e){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn(e)}function hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var dn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adConfig=t,this.thirdPartyConfig={},t.DeliveryGroups&&t.DeliveryGroups[t.AdServer.deliveryGroupId]&&t.DeliveryGroups[t.AdServer.deliveryGroupId].thirdPartyTracking&&(this.thirdPartyConfig=t.DeliveryGroups[t.AdServer.deliveryGroupId].thirdPartyTracking)}var t,n;return t=e,(n=[{key:"getUrls",value:function(e){var t=this,n=e.event,r=[];if("object"!==fn(n))return r;var i=n.trigger===pt.trigger.CLICK?this.thirdPartyConfig.clicks:this.thirdPartyConfig.events;if(!i)return r;var o=n.meta&&n.meta.eventName?n.meta.eventName:n.name;return i.forEach((function(n){e.type===n.type&&o===n.name&&r.push(P.fillMacros(n.url,t.adConfig))})),r}},{key:"replaceCacheBuster",value:function(e){return P.fillMacros(e,this.adConfig)}}])&&hn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.ThirdPartyTracker=dn;var pn=dn;function vn(e){return vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vn(e)}function yn(){return yn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yn.apply(this,arguments)}function mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bn="_DELIVR_CLK_URL_",gn="_DELIVR_GENERIC_CLK_",En=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.platform=new an(t),this.adServer=new Jt(t),this.publisher=new ln(t),this.thirdParty=new pn(t),this.trackers=[this.publisher,this.platform,this.adServer,this.thirdParty],this.advertEventBus=n.eventBus,this.globalEventBus=n.globalEventBus,this.adConfig=t,this.disabled=!0===this.adConfig.Integrator.previewMode,this.initialiseEventCounters(),this.advertEventBus.on(pt.TRACKING_REQUEST,(function(e){return r.creativeEventHandler(e)}))}var t,n;return t=e,n=[{key:"initialiseEventCounters",value:function(){var e=this.adConfig.Creative.events;Object.keys(e).forEach((function(t){e[t].counter=e[t].counter||0}))}},{key:"incrementEventCounter",value:function(e){var t=this.adConfig.Creative.events,n=e.meta&&e.meta.eventName?e.meta.eventName:e.name;n in t||(t[n]={counter:0}),"number"==typeof t[n].counter&&t[n].counter++}},{key:"prepareClickRedirects",value:function(){var t=this;this.adConfig.Platform=this.adConfig.Platform||{},this.adConfig.Platform.CLICK_PLACEHOLDER=bn,this.adConfig.Format=this.adConfig.Format||{},this.adConfig.Format.library=this.adConfig.Format.library||{},this.adConfig.Format.library.config=yn(this.adConfig.Format.library.config||{},{GENERIC_CLICK_KEY:gn,CLICK_URL_PLACEHOLDER:bn});var n=function(e,t){return t+encodeURIComponent(e)},r=this.adConfig.Creative.clicks;r[gn]={},Object.keys(r).forEach((function(i){if(t.disabled)r[i].redirect=r[i].url||"";else{r[i].url=P.fillMacros(r[i].url,t.adConfig);for(var o=[],a=t.trackers,s=0;s<a.length;s++){var c=a[s];i===gn&&c instanceof pn||t.adServer.servedBy("ADTECH")&&c instanceof Jt||(o=o.concat(c.getUrls({type:e.type.REDIRECT,event:{name:i,trigger:pt.trigger.CLICK}})))}o.push(bn),o.reverse(),r[i].redirect=o.reduce(n),r[i].redirectCount=o.length}}))}},{key:"performTrackingRequests",value:function(t){for(var n=[],r=[],i=[],o=this.trackers,a=0;a<o.length;a++){var s=o[a];n=n.concat(s.getUrls({type:e.type.PIXEL,event:t})),r=r.concat(s.getUrls({type:e.type.SCRIPT,event:t})),t.trigger===pt.trigger.CLICK&&(i=i.concat(s.getUrls({type:e.type.REDIRECT,event:t})))}if(this.disabled||(P.requestPixels(n),P.loadScripts(r,this.adConfig.anchorDivId)),t.trigger===pt.trigger.CLICK){var c=t.meta||{},u=this.getClickLandingUrl(t.name,c.url);u&&i.push(u)}var l=this.platform.buildGenericParams({event:t}),f=new Ft(Ft.TRACK,{name:l.en,platformEventType:l.et,urls:{pixels:n,scripts:r,redirects:i}});this.advertEventBus.trigger(f)}},{key:"reportPrependedEvents",value:function(){var e=this,t=this.getPrependedEvents();t&&t.length>0&&t.forEach((function(t){var n=new Ft(Ft.TRACK,t);e.advertEventBus.trigger(n)}))}},{key:"getPrependedEvents",value:function(){var e,t=this.adConfig.Creative.id;try{e=window.com.yahoo.craft.prependedTrackerEvents[t]}catch(e){}return e&&e.length>0?e:null}},{key:"populateEventMeta",value:function(e){var t=e.meta&&e.meta.eventName?e.meta.eventName:e.name,n={};for(var r in this.adConfig.Creative.events)if(this.adConfig.Creative.events.hasOwnProperty(r)&&t===r){n=this.adConfig.Creative.events[r];break}e.meta=yn({},n,e.meta)}},{key:"creativeEventHandler",value:function(e){if("object"===vn(e))switch(e.trigger){case pt.trigger.CLICK:this.performTrackingRequests(e);break;case pt.trigger.EVENT:this.populateEventMeta(e),(!e.meta.trackOnce||void 0===e.meta.counter||"number"==typeof e.meta.counter&&e.meta.counter<1)&&!0!==e.meta.suppressTracking&&(this.performTrackingRequests(e),this.incrementEventCounter(e))}}},{key:"getClickRedirectUrl",value:function(e,t){var n=this.adConfig.Format.library.config.GENERIC_CLICK_KEY,r=this.adConfig.Creative.clicks[e]||this.adConfig.Creative.clicks[n],i=t;!i&&r&&(i=r.url);var o=this.adConfig.Format.library.config.CLICK_URL_PLACEHOLDER;if(r&&r.redirect&&r.redirect.length&&r.redirectCount&&o){for(var a=i,s=e,c=1;c<r.redirectCount;c++)a=encodeURIComponent(a),s=encodeURIComponent(s);return r.redirect.replace(o,a).replace(n,s)}return i}},{key:"getClickLandingUrl",value:function(e,t){var n=this.adConfig.Creative.clicks[e],r=t;return!r&&n&&(r=n.url),P.fillMacros(r,this.adConfig)}}],n&&mn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();En.event={BACKUP_IMPRESSION:"backupImpression",DOWNLOADED_IMPRESSION:"downloadedImpression",RENDERED_IMPRESSION:"renderedImpression",UNSUPPORTED_CLIENT:"unsupportedClient"},En.type={PIXEL:"pixel",REDIRECT:"redirect",SCRIPT:"script"},r.Tracker=En;var On=En;function wn(e){return wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wn(e)}function Cn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tn(e,t){return Tn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tn(e,t)}function Sn(e,t){if(t&&("object"===wn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function In(e){return In=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},In(e)}var Pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tn(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=In(n);if(r){var i=In(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Sn(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{key:null};return Cn(this,o),(t=i.call(this,e)).key=n.key,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);r.SafeFrameKeyUpdateEvent=Pn,Pn.UPDATE="SafeFrameKeyUpdateEvent.update";var An=Pn;function kn(e){return kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kn(e)}function Rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.containers={},this.darlaKey=null}var t,n;return t=e,n=[{key:"init",value:function(e,t){var n=this;if(e.Creative.containers.placement.type||(e.Creative.containers.placement.type=xe),this.adConfig=e,this.id=e.AdServer.cacheBuster,this.eventBus=new te(this),this.adManager=t,this.globalEventBus=t.globalEventBus,this.env=t.env,this.containerFactory=t.containerFactory,this.tracker=new t.trackerClass(e,this),this.tracker.prepareClickRedirects(),this.inspectr=new Xt(this),this.tracker.reportPrependedEvents(),this.eventBus.on(An.UPDATE,(function(e){null!==e.key&&(n.darlaKey=e.key)})),this.copyPropertiesFromAdConfig(e),this.checkTrackDownloadedImpression(),this.env.backupImage||e.getOverride(_.override.RENDER_BACKUP)){if(!this.initBackupContainer(e))return void this.trackEvent(On.event.UNSUPPORTED_CLIENT);this.trackEvent(On.event.BACKUP_IMPRESSION)}else this.initContainers(e);this.eventBus.trigger(H.INITIALIZED)}},{key:"cleanup",value:function(){this.inspectr.cleanup()}},{key:"checkTrackDownloadedImpression",value:function(){this.adConfig.Regs&&this.adConfig.Regs.downloadedImpressionPrepended?this.trackEvent(On.event.RENDERED_IMPRESSION):this.trackEvent(On.event.DOWNLOADED_IMPRESSION)}},{key:"copyPropertiesFromAdConfig",value:function(e){Z(e,["AdServer","Creative","Format","Integrator","Platform","Publisher","ThirdPartyTracking"],this)}},{key:"initBackupContainer",value:function(e){var t=e.Creative.containers.placement;if(t.type===xe){t.content=t.default.content,t.x=0,t.y=0;var n=this.containerFactory.getContainer(t.type,e,"placement",this,this.adManager);return this.containers.placement=n,n}return null}},{key:"initContainers",value:function(e){var t="placement",n=e.Creative.containers;n.hasOwnProperty(t)&&(this.containers[t]=this.containerFactory.getContainer(n[t].type,e,t,this,this.adManager)),Object.keys(n).forEach((function(e){e!==t&&delete n[e]})),this.eventBus.trigger(new Ze(Ze.RENDER))}},{key:"trackEvent",value:function(e){this.eventBus.trigger(new pt(pt.TRACKING_REQUEST,{trigger:pt.trigger.EVENT,name:e}))}},{key:"click",value:function(e,t){var n={};t&&t.url&&(n.url=t.url);var r=new pt(pt.TRACKING_REQUEST,{trigger:pt.trigger.CLICK,name:e,meta:n});this.eventBus.trigger(r),this.executeClick(r)}},{key:"executeClick",value:function(e){if("object"===kn(e)&&e.trigger&&e.trigger===pt.trigger.CLICK&&!e.clickExecuted){var t,n=e.name;e.meta&&e.meta.url&&(t=e.meta.url);var r=this.tracker.getClickRedirectUrl(n,t);this.openUrl(r),e.clickExecuted=!0}}},{key:"openUrl",value:function(e){window.open(e,"_blank")}}],n&&Rn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.Advert=_n;var Dn=_n;function jn(e){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jn(e)}function Ln(e,t){return Ln=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ln(e,t)}function Nn(e,t){if(t&&("object"===jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Un(e){return Un=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Un(e)}var Fn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ln(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Un(n);if(r){var i=Un(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Nn(this,e)});function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e)}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);Fn.MOUSE_OVER="mouseEvent.mouseOver",Fn.MOUSE_OUT="mouseEvent.mouseOut",r.MouseEvent=Fn;var xn=Fn;function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Bn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=e.state.UNQUALIFIED,this.mouseOverContainer=!1,this.buffer=[],this.rolloverThresholdTimeout=null,this.noRolloverFlushTimeout=null,this.touchStartHandlerFn=null,this.mouseOverHandlerFn=null,this.mouseOutHandlerFn=null,this.hoverOverThresholdPassed=!1,this.listenersAdded=!1,this.adEventBus=t,this.eventBus=new te(this),this.qualifiedUserClick=!1}var t,n;return t=e,(n=[{key:"init",value:function(){r.UserAgentUtils.isiOS()||r.UserAgentUtils.isAndroid()||r.UserAgentUtils.isWinPhone()?this.state=e.state.QUALIFIED:this.addListeners()}},{key:"addListeners",value:function(){var t=this;this.mouseOverHandlerFn=function(e){return t.containerMouseOverEventHandler(e)},this.mouseOutHandlerFn=function(e){return t.containerMouseOutEventHandler(e)},this.touchStartHandlerFn=function(e){return t.touchStartHandler(e)},this.setQualifiedUserClickFn=function(e){return t.setQualifiedUserClick(e)},this.adEventBus.on(xn.MOUSE_OVER,this.mouseOverHandlerFn),this.adEventBus.on(xn.MOUSE_OUT,this.mouseOutHandlerFn),this.adEventBus.on(e.QUALIFIED_CLICK,this.setQualifiedUserClickFn),window.addEventListener("touchstart",this.touchStartHandlerFn),this.listenersAdded=!0}},{key:"removeListeners",value:function(){this.listenersAdded&&(this.adEventBus.off(xn.MOUSE_OVER,this.mouseOverHandlerFn),this.adEventBus.off(xn.MOUSE_OUT,this.mouseOutHandlerFn),this.adEventBus.off(e.QUALIFIED_CLICK,this.setQualifiedUserClickFn),window.removeEventListener("touchstart",this.touchStartHandlerFn))}},{key:"bufferEvent",value:function(e){this.buffer[0]=e}},{key:"qualifies",value:function(t){var n=this;return!((!t.meta||!0!==t.meta.qualified)&&(this.state===e.state.UNQUALIFIED&&this.hoverOverThresholdPassed&&t.meta.interaction?(this.hoverOverThresholdPassed=!1,this.bufferEvent(t),setTimeout((function(){n.setStateToQualified()}),0),1):this.state!==e.state.QUALIFIED&&t.meta.interaction&&(this.bufferEvent(t),this.noRolloverFlushTimeout||this.mouseOverContainer||(this.noRolloverFlushTimeout=setTimeout((function(){n.noRolloverTimeoutCompleteHandler()}),e.NO_HOVER_FLUSH_TIMEOUT)),1)))}},{key:"setQualifiedUserClick",value:function(){this.qualifiedUserClick=!0}},{key:"startMouseOverTimer",value:function(){var t=this;this.rolloverThresholdTimeout||(this.rolloverThresholdTimeout=setTimeout((function(){t.rolloverThresholdTimeoutCompleteHandler()}),e.HOVER_THRESHOLD))}},{key:"setStateToQualified",value:function(){if(this.state!==e.state.QUALIFIED){this.state=e.state.QUALIFIED,this.removeListeners();var t=new Kt(Kt.QUALIFIED,{events:this.buffer});this.eventBus.trigger(t),this.adEventBus.trigger(t)}}},{key:"containerMouseOverEventHandler",value:function(){this.mouseOverContainer||(this.mouseOverContainer=!0,this.noRolloverFlushTimeout&&(clearTimeout(this.noRolloverFlushTimeout),this.noRolloverFlushTimeout=void 0),this.startMouseOverTimer())}},{key:"containerMouseOutEventHandler",value:function(){if(this.qualifiedUserClick&&this.buffer.length>0)return this.rolloverThresholdTimeoutCompleteHandler();this.mouseOverContainer&&(this.mouseOverContainer=!1,this.hoverOverThresholdPassed=!1,this.rolloverThresholdTimeout&&(clearTimeout(this.rolloverThresholdTimeout),this.rolloverThresholdTimeout=void 0,this.buffer=[]))}},{key:"touchStartHandler",value:function(){this.setStateToQualified()}},{key:"rolloverThresholdTimeoutCompleteHandler",value:function(){this.state===e.state.QUALIFIED||this.buffer.length>0&&this.mouseOverContainer?this.setStateToQualified():this.hoverOverThresholdPassed=!0}},{key:"noRolloverTimeoutCompleteHandler",value:function(){this.buffer=[]}}])&&Mn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.EventQualifier=Bn,Bn.HOVER_THRESHOLD=500,Bn.NO_HOVER_FLUSH_TIMEOUT=1e3,Bn.QUALIFIED_CLICK="eventQualifier.qualifiedClick",Bn.state={QUALIFIED:1,UNQUALIFIED:0};var Hn=Bn;function Vn(e){return Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vn(e)}function Qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Kn=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.advertEventBus=t,this.globalEventBus=r,this.eventQualifier=n,this.mouseIsOver=!1,this.eventBus=new te(this),this.isTouchDevice=!1,this.nextUserInteractionTimeout=null,this.userInitiatedExpanded=!1,this.userInitiatedVideoPlaying=!1,this.timerRunning=!1,this.initialised=!1}var t,n;return t=e,(n=[{key:"init",value:function(){var e=this;this.initialised||(this.isTouchDevice=r.UserAgentUtils.isiOS()||r.UserAgentUtils.isAndroid()||r.UserAgentUtils.isWinPhone(),this.qualifiedStateChangeHandlerFn=function(t){return e.qualifiedStateChangeHandler(t)},this.isTouchDevice||(this.advertEventBus.on(xn.MOUSE_OVER,(function(){return e.containerMouseOverEventHandler()})),this.advertEventBus.on(xn.MOUSE_OUT,(function(){return e.containerMouseOutEventHandler()})),this.eventQualifier.state===Hn.state.UNQUALIFIED&&this.eventQualifier.eventBus.on(Kt.QUALIFIED,this.qualifiedStateChangeHandlerFn)),this.globalEventBus.on(ce.VISIBILITY_CHANGE,(function(t){return e.visibilityChangeHandler(t)})),this.advertEventBus.on(pt.TRACKING_REQUEST,(function(t){return e.trackingRequestEventHandler(t)})),this.initialised=!0)}},{key:"clearNextUserInteractionTimeout",value:function(){this.nextUserInteractionTimeout&&(clearTimeout(this.nextUserInteractionTimeout),this.nextUserInteractionTimeout=null)}},{key:"resetNextUserInteractionTimeout",value:function(){var e=this;this.clearNextUserInteractionTimeout(),this.nextUserInteractionTimeout=setTimeout((function(){return e.nextUserInteractionTimeoutHandler()}),1e4)}},{key:"containerMouseOverEventHandler",value:function(){this.mouseIsOver||(this.mouseIsOver=!0,this.eventQualifier.state===Hn.state.QUALIFIED&&this.startTimer())}},{key:"containerMouseOutEventHandler",value:function(){if(this.mouseIsOver){if(this.mouseIsOver=!1,this.userInitiatedVideoPlaying||this.userInitiatedExpanded)return;this.stopTimer()}}},{key:"visibilityChangeHandler",value:function(e){e.visible||(this.mouseIsOver=!1,this.stopTimer())}},{key:"nextUserInteractionTimeoutHandler",value:function(){this.nextUserInteractionTimeout=null,this.userInitiatedExpanded||this.userInitiatedVideoPlaying||this.stopTimer()}},{key:"qualifiedStateChangeHandler",value:function(e){this.eventQualifier.state===Hn.state.QUALIFIED&&(this.eventQualifier.eventBus.off(Kt.QUALIFIED,this.qualifiedStateChangeHandlerFn),e.events.length>0&&this.interactionEventHandler(e.events[0]))}},{key:"videoTimerEventHandler",value:function(e){switch(e.trigger){case pt.trigger.TIMER_START:this.eventQualifier.state===Hn.state.QUALIFIED&&(this.isTouchDevice||this.mouseIsOver)&&(this.userInitiatedVideoPlaying=!0,this.startTimer());break;case pt.trigger.TIMER_STOP:this.userInitiatedVideoPlaying=!1,!this.isTouchDevice&&this.mouseIsOver||this.stopTimer()}}},{key:"nonInteractionEventHandler",value:function(e){this.userInitiatedExpanded&&e.name===ir.event.CONTRACT&&(this.userInitiatedExpanded=!1,this.stopTimer())}},{key:"interactionEventHandler",value:function(e){this.eventQualifier.state===Hn.state.QUALIFIED&&(this.isTouchDevice||this.mouseIsOver)&&(this.startTimer(),e.name===ir.event.EXPAND&&(this.userInitiatedExpanded=!0))}},{key:"trackingRequestEventHandler",value:function(e){if("object"===Vn(e))switch(e.trigger){case pt.trigger.TIMER_START:case pt.trigger.TIMER_STOP:e.meta.video&&this.videoTimerEventHandler(e);break;case pt.trigger.EVENT:e.meta.interaction?this.interactionEventHandler(e):this.nonInteractionEventHandler(e)}}},{key:"startTimer",value:function(){this.isTouchDevice&&this.resetNextUserInteractionTimeout(),this.timerRunning||(this.advertEventBus.trigger(new pt(pt.TRACKING_REQUEST,{trigger:pt.trigger.TIMER_START,name:ir.timer.INTERACTION})),this.timerRunning=!0)}},{key:"stopTimer",value:function(){this.isTouchDevice&&this.clearNextUserInteractionTimeout(),this.timerRunning&&(this.advertEventBus.trigger(new pt(pt.TRACKING_REQUEST,{trigger:pt.trigger.TIMER_STOP,name:ir.timer.INTERACTION})),this.timerRunning=!1)}}])&&Qn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.InteractionTimerManager=Kn;var Gn=Kn;function qn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qn(this,e),this.name=t,this.video=!!n.video,this.startTime=null,this.timeElapsed=0,this.cumulativeTimeElapsed=0,this.flushCount=1,this.running=!1}var t,n;return t=e,(n=[{key:"start",value:function(){this.running||(this.startTime=(new Date).getTime(),this.running=!0)}},{key:"stop",value:function(){this.running&&(this.timeElapsed+=(new Date).getTime()-this.startTime,this.running=!1)}},{key:"flush",value:function(){if(this.stop(),this.timeElapsed>0){var e=this.flushCount*this.timeElapsed+this.cumulativeTimeElapsed;return this.flushCount++,this.cumulativeTimeElapsed+=this.timeElapsed,this.timeElapsed=0,e}return 0}}])&&Wn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.Timer=Xn;var Yn=Xn;function zn(e){return zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zn(e)}function Zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $n(){return $n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Jn(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},$n.apply(this,arguments)}function Jn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nr(e)););return e}function er(e,t){return er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},er(e,t)}function tr(e,t){if(t&&("object"===zn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function nr(e){return nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nr(e)}var rr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&er(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nr(r);if(i){var n=nr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return tr(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e,t)).userInteracted=!1,n.expandedOnce=!1,n.videoPlaybackInitiated=!1,n.timers={},n.flushTimersTimeout=null,n.disableTimers=!1,n.mouseOverContainer=!1,n.interactionsQualified=!1,n.isTouchDevice=Ie()||Pe()||Ae(),n.qualifier=new Hn(n.advertEventBus),n.qualifier.init(),n.qualifierStateChangeHandlerFn=function(e){return n.qualifierStateChangeHandler(e)},n.qualifier.eventBus.on(Kt.QUALIFIED,n.qualifierStateChangeHandlerFn),n.interactionTimerManager=new Gn(t.eventBus,n.qualifier,t.globalEventBus),n.interactionTimerManager.init(),n.isTouchDevice||(n.advertEventBus.on(xn.MOUSE_OVER,(function(){return n.containerMouseOverEventHandler()})),n.advertEventBus.on(xn.MOUSE_OUT,(function(){return n.containerMouseOutEventHandler()}))),n.globalEventBus.on(ve.BEFORE_UNLOAD,(function(){return n.pageUnloadHandler()})),n.advertEventBus.on(pt.QUALIFIED_CLICK,(function(){return n.qualifiedClickHandler()})),n}return t=a,n=[{key:"qualifiedClickHandler",value:function(){this.interactionsQualified||this.advertEventBus.trigger(Hn.QUALIFIED_CLICK)}},{key:"getTimer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.timers.hasOwnProperty(e)||(this.timers[e]=new Yn(e,t)),this.timers[e]}},{key:"flushTimers",value:function(){var e=this;this.displayTimerThresholdReached()&&(this.disableTimers=!0,this.creativeEventHandler({name:a.event.TIMER_CAP,trigger:pt.trigger.EVENT,meta:{trackOnce:!0}})),Object.keys(this.timers).forEach((function(t){e.flushTimer(t)})),this.disableTimers=!0}},{key:"displayTimerThresholdReached",value:function(){var e=this.getTimer(a.timer.DISPLAY);return("number"==typeof e.timeElapsed&&e.timeElapsed?e.timeElapsed:+new Date-e.startTime)>=9e5}},{key:"flushTimer",value:function(e){var t=this.getTimer(e),n=t.flush();if(0!==n){var r={type:On.type.PIXEL,event:{trigger:pt.trigger.TIMER_STOP,name:e,meta:{duration:n,video:t.video}}},i=this.platform.getUrls(r);this.disabled||this.disableTimers||P.requestPixels(i);var o=new Rt(Rt.TIMER_CHANGE,{timer:t,platformEventType:this.platform.getPixelEventType(r)});this.advertEventBus.trigger(o)}}},{key:"startFlushTimersCountdown",value:function(){var e=this;this.flushTimersTimeout||(this.flushTimersTimeout=window.setTimeout((function(){e.flushTimers()}),9e5))}},{key:"containerMouseOverEventHandler",value:function(){this.mouseOverContainer||(this.mouseOverContainer=!0)}},{key:"containerMouseOutEventHandler",value:function(){this.mouseOverContainer&&(this.mouseOverContainer=!1)}},{key:"creativeExpansionHandler",value:function(){this.expandedOnce||($n(nr(a.prototype),"creativeEventHandler",this).call(this,{name:a.event.EXPANDED_IMPRESSION,trigger:pt.trigger.EVENT}),this.expandedOnce=!0)}},{key:"userInteractionHandler",value:function(){this.userInteracted||($n(nr(a.prototype),"creativeEventHandler",this).call(this,{name:a.event.INTERACTIVE_IMPRESSION,trigger:pt.trigger.EVENT}),this.userInteracted=!0,this.advertEventBus.trigger(H.INTERACTIVE_IMPRESSION))}},{key:"videoStartHandler",value:function(){this.videoPlaybackInitiated||($n(nr(a.prototype),"creativeEventHandler",this).call(this,{name:a.event.VIDEO_IMPRESSION,trigger:pt.trigger.EVENT,meta:{video:!0}}),this.videoPlaybackInitiated=!0)}},{key:"qualifierStateChangeHandler",value:function(e){var t=this;this.interactionsQualified=!0,this.qualifier.eventBus.off(Kt.QUALIFIED,this.qualifierStateChangeHandlerFn),e.events.forEach((function(e){return t.creativeEventHandler(e)}))}},{key:"timerStartEventHandler",value:function(e){switch(e.name){case a.timer.DISPLAY:this.startFlushTimersCountdown();break;case a.timer.EXPANSION:this.creativeExpansionHandler()}var t=!(!e.meta||!e.meta.video),n=this.getTimer(e.name,{video:t});n.start();var r={event:{trigger:pt.trigger.TIMER_START,name:name,meta:{video:n.video}}},i=new Rt(Rt.TIMER_CHANGE,{timer:n,platformEventType:this.platform.getPixelEventType(r)});this.advertEventBus.trigger(i)}},{key:"timerStopEventHandler",value:function(e){e.name===a.timer.DISPLAY||e.name===a.timer.VIEW?this.getTimer(e.name).stop():this.flushTimer(e.name)}},{key:"creativeEventHandler",value:function(e){if("object"===zn(e)){switch(e.trigger){case pt.trigger.TIMER_START:if(this.disableTimers)return;this.timerStartEventHandler(e);break;case pt.trigger.TIMER_STOP:this.timerStopEventHandler(e);break;case pt.trigger.CLICK:this.userInteractionHandler(),this.interactionsQualified=!0,this.qualifier.setStateToQualified();break;case pt.trigger.EVENT:if(this.populateEventMeta(e),!this.interactionsQualified&&!this.qualifier.qualifies(e))return;e.meta.interaction&&this.userInteractionHandler(),e.meta.video&&0===e.meta.durationPercentage&&this.videoStartHandler()}$n(nr(a.prototype),"creativeEventHandler",this).call(this,e)}}},{key:"pageUnloadHandler",value:function(){this.flushTimers()}}],n&&Zn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(On);rr.timer={DISPLAY:"display",EXPANSION:"expansion",INTERACTION:"interaction",VIEW:"view"},rr.event={CONTRACT:"contract",EXPAND:"expand",EXPANDED_IMPRESSION:"expandedImpression",INTERACTIVE_IMPRESSION:"interactiveImpression",VIDEO_IMPRESSION:"videoImpression",TIMER_CAP:"timerCap"},r.RichTracker=rr;var ir=rr;function or(e){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},or(e)}function ar(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sr(e,t){return sr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sr(e,t)}function cr(e,t){if(t&&("object"===or(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ur(e){return ur=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ur(e)}var lr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sr(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ur(n);if(r){var i=ur(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return cr(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ar(this,o),(t=i.call(this,e)).uid=n.uid||null,t.action=n.action,t.state=n.state||null,t.containerId=n.containerId||null,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);lr.ACTION_REQUEST="containerActionRequestEvent.actionRequest",r.ContainerActionRequestEvent=lr;var fr=lr;function hr(e){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hr(e)}function dr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pr(e,t){return pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pr(e,t)}function vr(e,t){if(t&&("object"===hr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function yr(e){return yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yr(e)}var mr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pr(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yr(n);if(r){var i=yr(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return vr(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dr(this,o),(t=i.call(this,e)).containerId=n.containerId||null,t.state=n.state||null,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);mr.STATE_CHANGE="containerStateChangeEvent.stateChange",mr.state={EXPAND:"expand",CONTRACT:"contract"},r.ContainerStateChangeEvent=mr;var br=mr;function gr(e){return gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gr(e)}function Er(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Or(e,t){return Or=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Or(e,t)}function wr(e,t){if(t&&("object"===gr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Cr(e){return Cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Cr(e)}var Tr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Or(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Cr(n);if(r){var i=Cr(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return wr(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Er(this,o),(t=i.call(this,e)).viewable=n.viewable||null,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);Tr.CHANGE="viewableChangeEvent.change",r.ViewableChangeEvent=Tr;var Sr=Tr;function Ir(e){return Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ir(e)}function Pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ar(){return Ar="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=kr(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Ar.apply(this,arguments)}function kr(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dr(e)););return e}function Rr(e,t){return Rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rr(e,t)}function _r(e,t){if(t&&("object"===Ir(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Dr(e){return Dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dr(e)}var jr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rr(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Dr(r);if(i){var n=Dr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _r(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).rendered=!1,e.qualifiedRolloverThreshold=a.QUALIFIED_ROLLOVER_THRESHOLD,e.mobileInteractionThreshold=a.MOBILE_INTERACTION_THRESHOLD,e.viewableImpressionThreshold=Dn.VIEWABLE_IMPRESSION_THRESHOLD,e}return t=a,n=[{key:"init",value:function(e,t){Ar(Dr(a.prototype),"init",this).call(this,e,t)}},{key:"processOverrides",value:function(e){for(var t=["qualifiedRolloverThreshold","mobileInteractionThreshold","viewableImpressionThreshold"],n=0;n<t.length;n++){var r=t[n],i=e.getOverride(r);null!==i&&(this[r]=i)}}},{key:"initBackupContainer",value:function(e){return Ar(Dr(a.prototype),"initBackupContainer",this).call(this,e)}},{key:"initContainers",value:function(e){var t=this;for(var n in this.eventBus.on(fr.ACTION_REQUEST,(function(e){return t.containerActionEventHandler(e)})),e.Creative.containers)if(e.Creative.containers.hasOwnProperty(n)){this.containers[n]=this.containerFactory.getContainer(e.Creative.containers[n].type,e,n,this,this.adManager);var r=this.containers[n];r.eventBus.on(Ze.RENDER,(function(){return t.renderEventHandler()})),r.eventBus.on(Sr.CHANGE,(function(){return t.containerViewChangeHandler()})),r.expandable&&r.eventBus.on(br.STATE_CHANGE,(function(){return t.containerExpansionStateChangeHandler()}))}}},{key:"renderEventHandler",value:function(){if(!this.rendered){this.rendered=!0;var e=new pt(pt.TRACKING_REQUEST,{trigger:pt.trigger.TIMER_START,name:ir.timer.DISPLAY});this.eventBus.trigger(e)}}},{key:"containerExpansionStateChangeHandler",value:function(){var e=this,t=pt.trigger.TIMER_STOP;Object.keys(this.containers).forEach((function(n){e.containers[n].state!==tt.state.DEFAULT&&(t=pt.trigger.TIMER_START)}));var n=new pt(pt.TRACKING_REQUEST,{trigger:t,name:ir.timer.EXPANSION});this.eventBus.trigger(n)}},{key:"containerViewChangeHandler",value:function(){var e=pt.trigger.TIMER_STOP;for(var t in this.containers)if(this.containers.hasOwnProperty(t)&&this.containers[t].visible){e=pt.trigger.TIMER_START;break}var n=new pt(pt.TRACKING_REQUEST,{trigger:e,name:ir.timer.VIEW});this.eventBus.trigger(n)}},{key:"containerActionEventHandler",value:function(e){var t=this,n=Object.keys(this.containers),r=[e];if(1===n.length){var i=this.containers[n[0]];i[e.action].apply(i,r)}else{if(e.containerId){var o=this.containers[e.containerId];return void(o&&o[e.action].apply(o,r))}this.Creative.actions&&this.Creative.actions.hasOwnProperty(e.action)&&this.Creative.actions[e.action].forEach((function(n){if(n.source===e.target.containerId||"*"===n.source){var i=t.containers[n.target];i&&i[n.action].apply(i,r)}}))}}}],n&&Pr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Dn);jr.QUALIFIED_ROLLOVER_THRESHOLD=500,jr.MOBILE_INTERACTION_THRESHOLD=1e4,r.RichAdvert=jr;var Lr=jr;function Nr(e){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nr(e)}function Ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fr(){return Fr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=xr(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Fr.apply(this,arguments)}function xr(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Hr(e)););return e}function Mr(e,t){return Mr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mr(e,t)}function Br(e,t){if(t&&("object"===Nr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Hr(e){return Hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hr(e)}var Vr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mr(e,t)}(s,e);var t,n,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Hr(i);if(o){var n=Hr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Br(this,e)});function s(e,t,n,r,i,o){var c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(c=a.call(this,e,t,n,r,i,o)).anchorDiv=null,c.contentDiv=null,c.anchorDivAttemptIntervals=[10,20,50,100,200,500],c.preventRender=!1,c}return t=s,(n=[{key:"init",value:function(e){Fr(Hr(s.prototype),"init",this).call(this,e),this.setAnchorDivStyle(),this.prepareAnchorDiv(),this.anchorDiv&&this.content&&this.content.setContext(this.anchorDiv.ownerDocument,this.anchorDiv.ownerDocument.defaultView);var t=e.getOverride("domLoadTimeout");this.domLoadTimeout=null!==t?t:s.DOM_LOAD_TIMEOUT}},{key:"getAnchorLayoutState",value:function(){return this.getState(tt.state.DEFAULT)}},{key:"getInitialLayoutState",value:function(){return this.getAnchorLayoutState()}},{key:"setAnchorDivStyle",value:function(){var e=this.getAnchorLayoutState().data;this.anchorDivStyle={position:"relative",display:"block",width:d(e.width),height:d(e.height),verticalAlign:"top"}}},{key:"prepareAnchorDiv",value:function(){if(this.anchorDiv=this.getAnchorDiv(),!this.anchorDiv&&this.containerAnchorParent)this.anchorDiv=document.createElement("div"),this.anchorDiv.id=this.containerAnchorId,this.containerAnchorParent.appendChild(this.anchorDiv),this.anchorDivStyle.display="inline-block";else if(!this.anchorDiv&&this.advertAnchorPlaceholder)this.anchorDiv=document.createElement("div"),this.anchorDiv.id=this.advertAnchorId,this.advertAnchorPlaceholder.parentNode.insertBefore(this.anchorDiv,this.advertAnchorPlaceholder),l(this.advertAnchorPlaceholder,{display:"none"}),this.anchorDivStyle.display="inline-block";else if(!this.anchorDiv){try{console.warn('[CRAFT:Anchor "'.concat(this.advertAnchorId,'" not present in current window context]'))}catch(e){}return}r.DOMUtils.applyStyles(this.anchorDiv,this.anchorDivStyle)}},{key:"checkAutoRender",value:function(){this.rendered||!this.autoRender||this.hostPage.domLoaded||this.addDOMLoadRenderTimeout(),Fr(Hr(s.prototype),"checkAutoRender",this).call(this)}},{key:"addDOMLoadRenderTimeout",value:function(){var e=this;this.hostPage.domLoaded||this.domLoadRenderTimeout||(this.domLoadRenderTimeout=window.setTimeout((function(){e.forceRendering()}),this.domLoadTimeout))}},{key:"forceRendering",value:function(){this.render()}},{key:"getAnchorDiv",value:function(){var e=this.containerAnchorId||this.advertAnchorId,t=document.getElementById(e)||this.advertAnchorDiv;return t||(t=m(e,window)),t}},{key:"render",value:function(){var e=this;if(!this.rendered&&!this.closed){if(!this.anchorDiv&&(this.anchorDiv=this.getAnchorDiv(),!this.anchorDiv))return this.anchorDivAttemptIntervals.length>0?void window.setTimeout((function(){return e.render()}),this.anchorDivAttemptIntervals.shift()):void 0;this.createContentDiv();var t=this.anchorDiv.ownerDocument;this.contentDiv=t.getElementById(this.contentId)||m(this.contentId,t),this.adConfig.DeliveryServerTag&&this.adConfig.DeliveryServerTag.variables&&this.adConfig.DeliveryServerTag.variables.srvrid&&this.contentDiv.setAttribute(s.REQUEST_ID_ATTR,this.adConfig.DeliveryServerTag.variables.srvrid),this.content.render(),Fr(Hr(s.prototype),"render",this).call(this)}}},{key:"createContentDiv",value:function(){var e=this.getInitialLayoutState().data,t=document.createElement("div");t.id=this.contentId,l(t,{position:"absolute",width:d(e.width),height:d(e.height),left:"0",top:"0","text-align":"left"}),this.anchorDiv.appendChild(t)}},{key:"reload",value:function(){this.rendered?(this.content.remove(),this.content.forcePageLoad(),this.content.render(),this.show()):this.render()}},{key:"close",value:function(){if(this.rendered&&!this.closed){Fr(Hr(s.prototype),"close",this).call(this);try{this.contentDiv.parentNode===this.anchorDiv||this.contentDiv.parentNode.removeChild(this.contentDiv),this.anchorDiv.parentNode.removeChild(this.anchorDiv)}catch(e){}}}}])&&Ur(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(tt);Vr.DOM_LOAD_TIMEOUT=2e3,Vr.REQUEST_ID_ATTR="data-request-id",r.InlineDivContainer=Vr;var Qr=Vr;function Kr(e){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kr(e)}function Gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qr(e,t){return qr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qr(e,t)}function Wr(e,t){if(t&&("object"===Kr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xr(e){return Xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xr(e)}var Yr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qr(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xr(n);if(r){var i=Xr(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Wr(this,e)});function o(){return Gr(this,o),i.apply(this,arguments)}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);Yr.READY="contentEvent.ready",r.ContentEvent=Yr;var zr=Yr;function Zr(e){return Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(e)}function $r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jr(e,t){return Jr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jr(e,t)}function ei(e,t){if(t&&("object"===Zr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ti(e){return ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ti(e)}var ni=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jr(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ti(n);if(r){var i=ti(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return ei(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $r(this,o),(t=i.call(this,e)).uid=n.uid||null,t.action=n.action,t.state=n.state||null,t.containerId=n.containerId||null,t.status=n.status||null,t.detail=n.detail||"",t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(N);ni.status={SUCCESS:"success",FAILURE:"failure"},ni.action={EXPAND:"expand",CONTRACT:"contract"},ni.ACTION_COMPLETE="containerActionCompleteEvent.actionComplete",r.ContainerActionCompleteEvent=ni;var ri=ni;function ii(){return ii=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ii.apply(this,arguments)}function oi(e){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oi(e)}function ai(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var si=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adConfig=n,this.container=t,this.adEventBus=r.eventBus,this.adManager=r.adManager,this.htmlContent=i,this.windowContext=window,this.contentReady=!1,this.outgoingMessageQueue=[],this.initialized=!1,this.contentOrigin=null}var t,n;return t=e,(n=[{key:"init",value:function(){var e=this;this.initialized||(this.initialized=!0,this.windowContext.addEventListener("message",(function(t){return e.postMessageHandler(t)})),this.adEventBus.on(ri.ACTION_COMPLETE,(function(t){return e.containerActionEventCompleteHandler(t)})),this.adEventBus.on(ve.DETACH,(function(t){return e.containerDomDetatchEventHandler(t)})),this.adManager.globalEventBus.on(pt.GLOBAL_RELAY,(function(t){return e.globalRelayEventHandler(t)})))}},{key:"setContentOrigin",value:function(e){this.contentOrigin=e}},{key:"processMeta",value:function(e){if(null==e)return{};var t=e.trackOnce,n=e.suppressTracking,r=e.interaction,i=e.qualified,o={};return void 0!==i&&(o.qualified=i),void 0!==t&&(o.trackOnce=t),void 0!==n&&(o.suppressTracking=n),void 0!==r&&(o.interaction=r),o}},{key:"postMessageHandler",value:function(t){if(!this.shouldAcceptMessage(t))return!1;var n,r,i;this.adContentWindow=this.adContentWindow||t.source;var o={};try{o="object"===oi(t.data)?t.data:JSON.parse(t.data)}catch(e){console.error(e.message)}switch(o.topic){case e.topic.INIT:this.sendConfig();break;case e.topic.CLICK:case e.topic.EVENT:if(r={trigger:o.topic===e.topic.CLICK?pt.trigger.CLICK:pt.trigger.EVENT,name:o.meta.name,meta:ii({},this.processMeta(o.meta),o.meta.overrides)},o.meta.reportingLabel&&(r.reportingLabel=o.meta.reportingLabel),n=new pt(pt.TRACKING_REQUEST,r),this.dispatchAdvertLevelEvent(n),o.meta.global){var a=new pt(pt.GLOBAL_RELAY,o.meta);this.adManager.globalEventBus.trigger(a)}break;case e.topic.TIMER:n=new pt(pt.TRACKING_REQUEST,{trigger:o.meta.action,name:o.meta.name,meta:o.meta}),this.dispatchAdvertLevelEvent(n);break;case e.topic.CONTAINER_EVENT:n=new pt(pt.TRACKING_REQUEST,{trigger:pt.trigger.EVENT,name:o.meta.name,meta:o.meta.overrides}),this.dispatchAdvertLevelEvent(n),r={uid:o.meta.uid,action:o.meta.name,state:{key:o.meta.state},containerId:o.meta.container.id},i=new fr(fr.ACTION_REQUEST,r),this.dispatchAdvertLevelEvent(i);break;case e.topic.QUALIFIED_CLICK:n=new pt(pt.QUALIFIED_CLICK),this.dispatchAdvertLevelEvent(n)}return!0}},{key:"containerActionEventCompleteHandler",value:function(t){var n={uid:t.uid,container:t.containerId,state:t.state.key,name:t.action,status:t.status,detail:t.detail};this.dispatchToContent(this.constructMessage(e.topic.CONTAINER_EVENT_COMPLETE,n))}},{key:"containerDomDetatchEventHandler",value:function(e){e.container===this.container&&(this.contentReady=!1,this.adContentWindow=null)}},{key:"globalRelayEventHandler",value:function(t){this.dispatchToContent(this.constructMessage(e.topic.GLOBAL_RELAY_EVENT,{name:t.name,meta:t.meta}))}},{key:"shouldAcceptMessage",value:function(e){return!(e.origin!==this.contentOrigin||!this.htmlContent.contentObject||!this.htmlContent.contentObject.contentWindow||this.htmlContent.contentObject.contentWindow!==e.source)}},{key:"contentInitialised",value:function(){this.contentReady=!0,this.outgoingMessageQueue.length>0&&this.sendQueuedMessagesToContent(),this.htmlContent.eventBus.trigger(zr.READY)}},{key:"dispatchToContent",value:function(e){this.contentReady?this.sendMessage(e):this.addToOutgoingQueue(e)}},{key:"addToOutgoingQueue",value:function(e){this.outgoingMessageQueue.push(e)}},{key:"constructMessage",value:function(e,t){return{topic:e,meta:t}}},{key:"sendMessage",value:function(e){void 0!==this.adContentWindow&&this.adContentWindow.postMessage(e,this.contentOrigin)}},{key:"sendConfig",value:function(){if(!this.contentReady){var t={};Z(this.adConfig,["AdServer","Creative","Format","Integrator","Platform","Publisher","DeliveryGroups","DeliveryServerTag","User"],t),t.Format&&t.Format.library&&t.Format.library.hooks&&delete t.Format.library.hooks;var n={environment:this.adManager.env.type,container:{id:this.container.id,state:this.container.state},configuration:t};this.sendMessage(this.constructMessage(e.topic.INIT_COMPLETE,n)),this.contentInitialised()}}},{key:"dispatchAdvertLevelEvent",value:function(e){e.target=this.htmlContent,this.adEventBus.trigger(e)}},{key:"sendQueuedMessagesToContent",value:function(){var e=this;this.dispatchToContent(this.outgoingMessageQueue.shift()),this.outgoingMessageQueue.length>0&&setTimeout((function(){return e.sendQueuedMessagesToContent()}),this.QUEUED_MESSAGE_PUSH_DELAY)}}])&&ai(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();si.topic={INIT:"init",INIT_COMPLETE:"initComplete",CLICK:"click",QUALIFIED_CLICK:"qualifiedClick",EVENT:"event",CONTAINER_EVENT:"containerEvent",CONTAINER_EVENT_COMPLETE:"containerEventComplete",TIMER:"timer",GLOBAL_RELAY_EVENT:"globalRelayEvent"},si.QUEUED_MESSAGE_PUSH_DELAY=50,r.IframeCommunicator=si;var ci=si;function ui(){return ui=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ui.apply(this,arguments)}function li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fi=function(){function e(t,n,r,i,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventBus=new te(this),this.adEventBus=i.eventBus,this.globalEventBus=o.globalEventBus,this.container=t,this.containerEl=null,this.adConfig=n,this.mouseIsOver=null,this.containerId=r,this.contentObject=null,this.rendered=!1,this.DOMContext=document,this.advert=i,this.targetId=a,this.hostPage=o.hostPage,this.pageLoadForced=!1,this.iframeCommunicator=new ci(t,n,i,this),this.init()}var t,n;return t=e,(n=[{key:"init",value:function(){var t=this,n=this.adConfig.Creative.containers[this.containerId];this.content=n.content,this.width="100%",this.height="100%",this.globalEventBus.on(ce.LOAD,(function(e){return t.customEventHandler(e)})),this.globalEventBus.on(ce.RESIZE,(function(e){return t.customEventHandler(e)})),this.globalEventBus.on(ce.SCROLL,(function(e){return t.customEventHandler(e)}));for(var r=0;r<e.ADVERT_EVENTS_DISPATCH_TO_CONTENT.length;r++){var i=e.ADVERT_EVENTS_DISPATCH_TO_CONTENT[r];this.adEventBus.on(i,(function(e){return t.customEventHandler(e)}))}}},{key:"render",value:function(){this.containerEl=this.DOMContext.getElementById(this.targetId),this.containerEl&&null!==this.containerEl||(this.containerEl=m(this.targetId,this.DOMContext)),this.renderContent(),this.rendered=!0}},{key:"forcePageLoad",value:function(){this.iframeCommunicator.dispatchToContent(this.createContentEvent(new ce(ce.LOAD))),this.pageLoadForced=!0}},{key:"createContentEvent",value:function(e){var t={type:e.type};return ui(t,this.createContentEventProperties(e)),t}},{key:"createContentEventProperties",value:function(e){var t={},n=["type","target","currentTarget"];return Object.keys(e).forEach((function(r){z(r,n)||"function"==typeof e[r]||(t[r]=e[r])})),t}},{key:"setContext",value:function(e,t){this.DOMContext=e,this.iframeCommunicator.windowContext=t}},{key:"renderContent",value:function(){var e=this.targetId+"_iframe";this.iframeCommunicator.init();var t=this.adConfig.getFileUrl(this.content);this.hostPage.pageLoaded&&this.forcePageLoad(),this.iframeCommunicator.setContentOrigin(t.split("/").splice(0,3).join("/"));var n=document.createElement("iframe");n.id=e,n.src=t,n.scrolling="no",n.seamless="seamless",n.allowtransparency="true",n.allow=["accelerometer","autoplay","camera","fullscreen","geolocation","gyroscope","microphone"].join("; "),l(n,{width:"100%",height:"100%",border:"0px","background-color":"transparent",overflow:"hidden"}),r.IframeUtils.applyAllowFullScreenAttribute(n),this.containerEl.appendChild(n),ke()&&(n.style.visibility="hidden",setTimeout((function(){n.style.visibility="visible"}),200)),r.IframeUtils.isInFriendlyIframe()&&this.addAllowFullscreenAttribute(),this.contentObject=this.DOMContext.getElementById(e)||m(e,this.DOMContext)}},{key:"contentInitialised",value:function(){this.eventBus.trigger(zr.READY)}},{key:"customEventHandler",value:function(e){if(!(e.target===this||this.pageLoadForced&&e.type===ce.LOAD)){switch(e.type){case ce.LOAD:case ce.RESIZE:case ce.SCROLL:e.availableWidth=e.width,e.availableHeight=e.height,e.scrollOffsetTop=e.offsetY,e.scrollOffsetLeft=e.offsetX}this.iframeCommunicator.dispatchToContent(this.createContentEvent(e))}}},{key:"addAllowFullscreenAttribute",value:function(){for(var e=window.parent.document.getElementsByTagName("iframe"),t=0;t<e.length;t++)e[t].contentWindow===window&&ye(e[t])}}])&&li(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function hi(e){return hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hi(e)}function di(e,t){return di=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},di(e,t)}function pi(e,t){if(t&&("object"===hi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function vi(e){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vi(e)}fi.ADVERT_EVENTS_DISPATCH_TO_CONTENT=[H.INTERACTIVE_IMPRESSION],r.HtmlContent=fi;var yi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&di(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=vi(n);if(r){var i=vi(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return pi(this,e)});function o(e,t,n,r,a,s,c){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e,t,n,r,a,s,c)}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(fi);r.RichHtmlContent=yi;var mi=yi;function bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var gi=function(){function e(t,n,r,i,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventBus=new te(this),this.adEventBus=i.eventBus,this.container=t,this.advert=i,this.containerEl=null,this.contentReady=!1,this.rendered=!1,this.DOMContext=document,this.targetId=a,this.init(n,r)}var t,n;return t=e,(n=[{key:"init",value:function(e,t){var n=e.Creative.containers[t];this.content=n.content,this.width=n.states.default.width,this.height=n.states.default.height,this.setAdConfig(e)}},{key:"setAdConfig",value:function(e){this.adConfig=e,this.clickthroughs=e.Creative.clicks,this.adServerVars=e.AdServer}},{key:"render",value:function(){this.containerEl=this.DOMContext.getElementById(this.targetId),this.containerEl&&null!==this.containerEl||(this.containerEl=m(this.targetId,this.DOMContext)),this.renderContent(),this.rendered=!0}},{key:"renderContent",value:function(){this.containerEl.appendChild(this.getBackupImageNode(this.content)),this.contentInitialised()}},{key:"getBackupImageNode",value:function(e){var t=this,n=this.getDefaultClickId(),r=document.createElement("img");if(r.src=this.adConfig.getFileUrl(e),l(r,{border:0,width:"".concat(this.width,"px"),height:"".concat(this.height,"px")}),n){var i=document.createElement("a");return i.href=this.advert.tracker.getClickRedirectUrl(n,this.adConfig.Creative.clicks[n].url),i.target="_blank",i.addEventListener("click",(function(){var e=new pt(pt.TRACKING_REQUEST,{trigger:pt.trigger.CLICK,name:n});t.adEventBus.trigger(e)})),i.appendChild(r),i}return r}},{key:"getDefaultClickId",value:function(){if(this.adConfig.Creative.clicks.hasOwnProperty(e.DEFAULT_CLICK))return e.DEFAULT_CLICK;for(var t=Object.keys(this.adConfig.Creative.clicks),n=0;n<t.length;n++){var r=t[n];if(r.match(/^clicktag$/i))return r}return t[0]}},{key:"contentInitialised",value:function(){this.contentReady=!0,this.eventBus.trigger(zr.READY)}}])&&bi(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.BackupImageContent=gi,gi.DEFAULT_CLICK="default";var Ei=gi;function Oi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"getContent",value:function(e,t,n,r,i,o){return i.env.requiresBackupImage()||t.getOverride(_.override.RENDER_BACKUP)?new Ei(e,t,n,r,i,o):new mi(e,t,n,r,i,o)}}],null&&Oi(t.prototype,null),n&&Oi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.RichContentFactory=wi;var Ci=wi;function Ti(){return Ti=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ti.apply(this,arguments)}function Si(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ii=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"init",value:function(e){this.container=e,this.adEventBus=e.adEventBus;var t=e.adManager.env;this.isInFriendlyIframe=t.friendlyIframe,this.isInFriendlyIframe&&Oe()!==window.self&&(this.containingIframe=be(parent)),this.registerHostPageGeometricUpdate(!0)}},{key:"expand",value:function(e){this.dispatchContainerActionCompleteEvent({uid:e.uid,action:ri.action.EXPAND,state:e.state})}},{key:"contract",value:function(e){this.dispatchContainerActionCompleteEvent({uid:e.uid,action:ri.action.CONTRACT,state:e.state})}},{key:"dispatchContainerActionCompleteEvent",value:function(e){var t=Ti({status:ri.status.SUCCESS,detail:"",containerId:this.container.id},e),n=new ri(ri.ACTION_COMPLETE,t);this.adEventBus.trigger(n)}},{key:"getVisibilityMetrics",value:function(){var e=_e(this.isInFriendlyIframe),t=e.w,n=e.h,r=Re(this.isInFriendlyIframe),i=r.x,o=r.y,a=this.getVisibleDims(),s=a.w,c=a.h,u=f(this.containingIframe||this.container.contentDiv),l=u.x,h=u.y,d=s*c;return{maximumAdArea:d,percentInView:(i>=l+s||l-i>t?0:s-(i<l?0:Math.abs(l-i))-Math.max(l+s-t-i,0))*(o>=h+c||h-o>n?0:c-(o<h?0:Math.abs(h-o))-Math.max(h+c-n-o,0))/d}}},{key:"cleanup",value:function(){this.registerHostPageGeometricUpdate(!1)}},{key:"registerHostPageGeometricUpdate",value:function(e){for(var t=[ce.RESIZE,ce.SCROLL,ce.ORIENTATION_CHANGE],n=0;n<t.length;n++){var r=t[n];this.container.globalEventBus[e?"on":"off"](r,this.container.checkVisibility,this.container)}}},{key:"getVisibleDims",value:function(){return this.containingIframe?{w:parseInt(h(this.containingIframe,"width")),h:parseInt(h(this.containingIframe,"height"))}:{w:this.container.states[this.container.state].width,h:this.container.states[this.container.state].height}}}])&&Si(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.SimpleExpandAdapter=Ii;var Pi=Ii;function Ai(){return Ai=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ai.apply(this,arguments)}function ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ri=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"init",value:function(e,t){var n=this;this.container=e,this.adEventBus=e.adEventBus,this.initialState=t,this.commandQueue=[],this.activeCommand=null,this.safeFrameSandbox=window.frameElement,this.safeFrameAPI=window.parent.sfAPI||window.parent.$sf.ext,this.secureDarlaKey=null,r.createNamespace(parent).nsVersion[it.registration.PROXY_FN_NAME]((function(e,t){n.statusUpdateHandler(e,t)})),this.defaultState=this.container.getState(tt.state.DEFAULT),this.defaultState.key!==t.key&&this.expand({state:t})}},{key:"expand",value:function(t){var n=this.getArgumentObject();if(r.SafeFrameUtils.isInFlexFrame())return n.key=this.secureDarlaKey,n.ratio="".concat(t.state.data.width,"x").concat(t.state.data.height),void this.queueCommand(e.command.RESIZE_TO,[n],t);n.push=!(!t.state.data.push||!this.featureEnabled(e.feature.PUSH)),"number"!=typeof t.state.data.offsetX&&(t.state.data.offsetX=0),"number"!=typeof t.state.data.offsetY&&(t.state.data.offsetY=0);var i=this.defaultState.data;if(t.state.key===tt.state.FULLSCREEN){var o=this.safeFrameAPI.geom(),a=o.par&&o.par.t?parseInt(o.par.t):0;n.l=parseInt(o.self.l),n.r=parseInt(o.win.w)-(n.l+i.width),n.t=parseInt(o.self.t)-a,n.b=parseInt(o.win.h)-(n.t+i.height)+a,t.state.data.width=o.win.w,t.state.data.height=o.win.h}else{var s=Math.abs;n.l=s(s(i.offsetX)-s(t.state.data.offsetX)),n.r=s(t.state.data.width-(n.l+i.width)),n.t=s(s(i.offsetY)-s(t.state.data.offsetY)),n.b=s(t.state.data.height-(n.t+i.height))}Object.keys(n).forEach((function(e){0===n[e]&&delete n[e]})),this.queueCommand(e.command.EXPAND,[n],t)}},{key:"queueCommand",value:function(e,t,n){this.commandQueue.push({method:e,args:t,meta:n}),1===this.commandQueue.length&&this.executeNextCommand()}},{key:"executeNextCommand",value:function(){this.activeCommand=this.commandQueue.shift(),this.activeCommand.method===e.command.EXPAND?this.safeFrameAPI.expand(this.activeCommand.args[0]):this.safeFrameAPI[this.activeCommand.method].apply(this.safeFrameAPI,this.activeCommand.args)}},{key:"contract",value:function(t){if(r.SafeFrameUtils.isInFlexFrame()){var n=this.getArgumentObject();n.key=this.secureDarlaKey,n.ratio="".concat(t.state.data.width,"x").concat(t.state.data.height),this.queueCommand(e.command.RESIZE_TO,[n],t)}else this.queueCommand(e.command.COLLAPSE,[],t)}},{key:"resizeSandbox",value:function(){var e=this.activeCommand.meta.state.data;l(this.safeFrameSandbox,{width:"".concat(e.width,"px"),height:"".concat(e.height,"px")})}},{key:"getArgumentObject",value:function(){var e={};try{e=new parent.Object}catch(e){console.error(e.message)}return e}},{key:"featureEnabled",value:function(e){var t=this.safeFrameAPI.supports();return t&&t[e]}},{key:"getVisibilityMetrics",value:function(){var e=this.safeFrameAPI.geom().self;return{maximumAdArea:(e.b-e.t)*(e.r-e.l),percentInView:e.iv}}},{key:"cleanup",value:function(){}},{key:"dispatchContainerActionCompleteEvent",value:function(t,n){t=t===e.status.FAILED?ri.status.FAILURE:ri.status.SUCCESS;var r=Ai({},this.activeCommand.meta,{status:t,detail:n&&n.reason?n.reason:null,containerId:this.container.id}),i=new ri(ri.ACTION_COMPLETE,r);this.adEventBus.trigger(i)}},{key:"dispatchKeyUpdateEvent",value:function(){null!==this.secureDarlaKey&&this.adEventBus.trigger(new An(An.UPDATE,{key:this.secureDarlaKey}))}},{key:"statusUpdateHandler",value:function(t,n){switch(e.status.GEOM_UPDATE,t){case e.status.GEOM_UPDATE:break;case e.status.REGISTER:case e.status.REGISTER_UPDATE:try{this.secureDarlaKey=n.key}catch(e){w("[SafeFrameExpandAdapter]: Failed to retrieve DARLA key")}this.dispatchKeyUpdateEvent();break;case e.status.RESIZED:case e.status.COLLAPSED:case e.status.EXPANDED:this.resizeSandbox();case e.status.FAILED:this.dispatchContainerActionCompleteEvent(t,n)}this.commandQueue.length>0&&this.executeNextCommand()}}])&&ki(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.SafeFrameExpandAdapter=Ri,Ri.command={EXPAND:"expand",COLLAPSE:"collapse",RESIZE_TO:"resizeTo"},Ri.feature={PUSH:"exp-push",EXPAND_OVER:"exp-over",READ_COOKIE:"read-cookie",WRITE_COOKIE:"write-cookie"},Ri.status={GEOM_UPDATE:"geom-update",REGISTER:"register",REGISTER_UPDATE:"register-update",EXPANDED:"expanded",COLLAPSED:"collapsed",RESIZED:"resize-to",FAILED:"failed"};var _i=Ri;function Di(e){return Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Di(e)}function ji(){return ji=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ji.apply(this,arguments)}function Li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ni(){return Ni="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ui(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Ni.apply(this,arguments)}function Ui(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mi(e)););return e}function Fi(e,t){return Fi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fi(e,t)}function xi(e,t){if(t&&("object"===Di(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Mi(e){return Mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mi(e)}var Bi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fi(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Mi(r);if(i){var n=Mi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return xi(this,e)});function a(e,t,n,r,i,s){var c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(c=o.call(this,e,t,n,r,i,s)).mouseIsOver=!1,c.visibleinViewport=!1,c.visible=!1,c.pushesContent=!1,c.width=0,c.height=0,c.absLeft=0,c.absTop=0,c.initialParentHeight=0,c}return t=a,(n=[{key:"copyProperties",value:function(e){Ni(Mi(a.prototype),"copyProperties",this).call(this,e),this.initialState&&this.states.hasOwnProperty(this.initialState)||(this.initialState=tt.state.DEFAULT),this.expandable=Object.keys(this.states).length>1}},{key:"getInitialLayoutState",value:function(){return this.getState(this.initialState)}},{key:"getMaximumLayoutState",value:function(){for(var e=tt.STATE_PRECEDENCE.length,t=0;t<e;t++){var n=tt.STATE_PRECEDENCE[t];if(this.states.hasOwnProperty(n))return this.getState(n)}}},{key:"render",value:function(){var e=this;this.rendered||this.closed||(this.adEventBus.on(ri.ACTION_COMPLETE,(function(t){return e.containerActionCompleteHandler(t)})),Ni(Mi(a.prototype),"render",this).call(this),this.checkVisibility(),window.setTimeout((function(){return e.checkVisibility()}),Dn.VIEWABLE_IMPRESSION_THRESHOLD-300),this.addMouseListeners())}},{key:"createContentDiv",value:function(){var e,t,n=this.anchorDiv.ownerDocument,r=n.createElement("div");r.id=this.contentId,e=this.anchorDiv,this.initialState===tt.state.FULLSCREEN?(this.preventFullscreenDetach||(e=n.body),t=this.getFullscreenContentStyle()):t=this.getMaximumAnchoredContentStyle(),l(r,t),e.appendChild(r),this.initialParentHeight=h(this.anchorDiv.parentNode,"height"),this.adjustAnchorParent(this.getInitialLayoutState(this.initialState),!0)}},{key:"addMouseListeners",value:function(){var e=this;this.contentDiv.addEventListener("mouseenter",(function(){return e.triggerMouseOverEvent()}),!1),this.contentDiv.addEventListener("mouseleave",(function(){return e.triggerMouseOutEvent()}),!1)}},{key:"triggerMouseOverEvent",value:function(){if(!this.mouseIsOver){var e=new xn(xn.MOUSE_OVER);this.eventBus.trigger(e),this.adEventBus.trigger(e),this.mouseIsOver=!0}}},{key:"triggerMouseOutEvent",value:function(){if(this.mouseIsOver){var e=new xn(xn.MOUSE_OUT);this.eventBus.trigger(e),this.adEventBus.trigger(e),this.mouseIsOver=!1}}},{key:"checkVisibility",value:function(){}},{key:"triggerViewportEvent",value:function(e){var t=e.inViewport;!this.visibleinViewport&&t?(this.visibleinViewport=!0,this.eventBus.trigger(new Sr(Sr.CHANGE,{viewable:t}))):this.visibleinViewport&&!t&&(this.visibleinViewport=!1,this.eventBus.trigger(new Sr(Sr.CHANGE,{viewable:t})))}},{key:"expand",value:function(e){this.expandAdapter&&this.rendered&&this.expandable&&(this.states.hasOwnProperty(e.state.key)?e.state.data=this.states[e.state.key]:e.state=this.states.hasOwnProperty(tt.state.EXPAND)?this.getState(tt.state.EXPAND):this.getMaximumLayoutState(),this.state!==e.state.key&&this.expandAdapter&&this.expandAdapter.expand(e))}},{key:"contract",value:function(e){this.expandAdapter&&this.rendered&&this.expandable&&(this.states.hasOwnProperty(e.state.key)?e.state.data=this.states[e.state.key]:e.state=this.getState(tt.state.DEFAULT),this.state!==e.state.key&&this.expandAdapter&&this.expandAdapter.contract(e))}},{key:"getStateClippingRect",value:function(e){var t,n,r,i;return e===tt.state.FULLSCREEN?t={top:"auto",right:"auto",bottom:"auto",left:"auto"}:(r=(n=this.states[e]).offsetY||0,i=n.offsetX||0,t={top:Math.abs(r),right:Math.abs(i)+n.width,bottom:Math.abs(r)+n.height,left:Math.abs(i)}),t}},{key:"getFullscreenContentStyle",value:function(){return{position:"fixed",top:"0",left:"0",bottom:"0",right:"0",width:null,height:null}}},{key:"getMaximumAnchoredContentStyle",value:function(){var e=this.getStateClippingRect(this.initialState),t=this.getAnchorLayoutState(),n=this.getMaximumLayoutState();n.key===tt.state.FULLSCREEN&&(n=this.getState(tt.state.EXPAND)||t);var r=n.data,i=r.width,o=r.height;return ji({position:"absolute",width:d(i),height:d(o),border:"0px",left:t.data.offsetX+"px",top:t.data.offsetY+"px",clip:"rect(".concat(e.top,"px,").concat(e.right,"px,").concat(e.bottom,"px,").concat(e.left,"px)"),"text-align":"left"},this.getAnimationCSS())}},{key:"contentToAnchor",value:function(){l(this.contentDiv,this.getMaximumAnchoredContentStyle()),this.preventFullscreenDetach||this.contentDiv.parentNode===this.anchorDiv||(this.adEventBus.trigger(new ve(ve.DETACH,{container:this})),this.anchorDiv.appendChild(this.contentDiv))}},{key:"contentToFullscreen",value:function(){l(this.contentDiv,this.getFullscreenContentStyle());var e=this.anchorDiv.ownerDocument;this.preventFullscreenDetach||this.contentDiv.parentNode===e.body||(this.adEventBus.trigger(new ve(ve.DETACH,{container:this})),e.body.appendChild(this.contentDiv))}},{key:"adjustAnchorParent",value:function(e,t){if(e.key!==tt.state.FULLSCREEN){var n={},r={};e.data.push?(this.hasPushed=!0,n={height:d(e.data.height)},r={height:"auto"}):(n=this.anchorDivStyle,this.hasPushed||(r={height:this.initialParentHeight})),t||(n=ji(n,this.getAnchorAnimationCSS()),r=ji(r,this.getAnchorAnimationCSS())),l(this.anchorDiv,n),l(this.anchorDiv.parentNode,r)}}},{key:"getAnchorAnimationCSS",value:function(){return this.transition?{transition:"height ".concat(this.transition.duration," ").concat(this.transition.timingFunction)}:{}}},{key:"getAnimationCSS",value:function(){return this.transition?{transition:"clip ".concat(this.transition.duration," ").concat(this.transition.timingFunction)}:{}}},{key:"contractionCompleteHandler",value:function(e){this.adjustAnchorParent(e.state);var t=this.getStateClippingRect(e.state.key),n={clip:"rect(".concat(t.top,"px,").concat(t.right,"px,").concat(t.bottom,"px,").concat(t.left,"px)"),"z-index":this.zIndex+1};l(this.contentDiv,n),this.state===tt.state.FULLSCREEN&&this.contentToAnchor(),l(this.anchorDiv,{"z-index":this.zIndex}),this.state=e.state.key,this.eventBus.trigger(new br(br.STATE_CHANGE,{state:br.state.CONTRACT}))}},{key:"expansionCompleteHandler",value:function(e){this.adjustAnchorParent(e.state);var t=this.getStateClippingRect(e.state.key),n=e.state.key===tt.state.FULLSCREEN?"":"px",r={clip:"rect(".concat(t.top).concat(n,",").concat(t.right).concat(n,",").concat(t.bottom).concat(n,",")+"".concat(t.left).concat(n,")"),"z-index":this.zIndex+a.ZINDEX_BUMP};l(this.contentDiv,r),this.state===tt.state.FULLSCREEN?this.contentToAnchor():e.state.key===tt.state.FULLSCREEN&&this.contentToFullscreen(),this.state=e.state.key,this.eventBus.trigger(new br(br.STATE_CHANGE,{state:br.state.EXPAND}))}},{key:"containerActionCompleteHandler",value:function(e){if(e.containerId===this.id&&e.status===ri.status.SUCCESS)switch(e.action){case ri.action.EXPAND:this.expansionCompleteHandler(e);break;case ri.action.CONTRACT:this.contractionCompleteHandler(e)}}},{key:"coreLibEventHandler",value:function(e){Ni(Mi(a.prototype),"coreLibEventHandler",this).call(this,e),this.rendered&&(e.type===ve.LOAD||ce.LOAD)&&this.checkVisibility()}}])&&Li(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Qr);r.RichInlineDivContainer=Bi,Bi.ZINDEX_BUMP=10;var Hi=Bi;function Vi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"getContainer",value:function(e,t,n,r,i){return i.env.requiresBackupImage()||t.getOverride(_.override.RENDER_BACKUP)?new Qr(Ci,t,n,r,i):(o=i.env.safeFrameSandbox?new _i:new Pi,new Hi(Ci,t,n,r,i,o));var o}}],null&&Vi(t.prototype,null),n&&Vi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.RichContainerFactory=Qi;var Ki=Qi;function Gi(e){return Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gi(e)}function qi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wi(){return Wi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Xi(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Wi.apply(this,arguments)}function Xi(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zi(e)););return e}function Yi(e,t){return Yi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yi(e,t)}function zi(e,t){if(t&&("object"===Gi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zi(e){return Zi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zi(e)}var $i=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yi(e,t)}(s,e);var t,n,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Zi(i);if(o){var n=Zi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return zi(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.call(this,s.getOptionsForSuper())}return t=s,r=[{key:"getOptionsForSuper",value:function(){return{advertClass:Lr,breakoutFactory:st,containerFactory:Ki,trackerClass:ir}}}],(n=[{key:"registerAd",value:function(e){e.AdManager=s.references,Wi(Zi(s.prototype),"registerAd",this).call(this,e)}},{key:"initAd",value:function(e){Wi(Zi(s.prototype),"initAd",this).call(this,e)}}])&&qi(t.prototype,n),r&&qi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(Fe);$i.references={NAME:"richAdManager",CONFIG_QUEUE:"richAdConfigQueue",LOADED_VERSIONS:"richAdManagerVersions"},r.RichAdManager=$i;var Ji=$i,eo=r.richAdManager;if(void 0===eo){var to=r[Ji.references.CONFIG_QUEUE];eo=r[Ji.references.NAME]=new Ji,void 0!==to&&eo.registerAds(to)}}()}();
//# sourceMappingURL=Delivr-2.10.0.js.map